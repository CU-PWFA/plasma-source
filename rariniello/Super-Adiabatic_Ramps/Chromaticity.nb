(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87872,       2631]
NotebookOptionsPosition[     83858,       2491]
NotebookOutlinePosition[     84197,       2506]
CellTagsIndexPosition[     84154,       2503]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]\[Delta]", ">", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.741360916843995*^9, 3.741360929465207*^9}, {
   3.741362015355028*^9, 3.741362017418942*^9}, 3.74163117615458*^9, {
   3.742657575946876*^9, 3.742657577546051*^9}}],

Cell["\<\
To find the chromatic emittance growth in a beam we need the CS parameters as \
a function of energy spread.\
\>", "Text",
 CellChangeTimes->{{3.7413594190115013`*^9, 3.7413594506195908`*^9}, {
  3.74136088360815*^9, 3.7413609144968987`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox["\[Delta]", "2"]}], ")"}], " ", 
    RowBox[{"f", "[", "s", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]c", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Bm", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"s", ",", " ", "\[Delta]"}], "]"}]}], "]"}]}], "-", 
      RowBox[{"A", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "+", "Bp"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", "\[Delta]_", "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", "\[Sigma]\[Delta]"}]], 
    RowBox[{"UnitBox", "[", 
     RowBox[{"\[Delta]", "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "\[Sigma]\[Delta]"}], ")"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]p", "[", "s_", "]"}], "=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"\[Beta]c", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.741359455817419*^9, 3.74135961471684*^9}, {
  3.7413597340916243`*^9, 3.741359806595096*^9}, {3.7413601211970377`*^9, 
  3.7413604210192547`*^9}, {3.741360650080388*^9, 3.7413606661097727`*^9}, {
  3.7413609573644323`*^9, 3.741361012731344*^9}, {3.741361108749423*^9, 
  3.741361109117961*^9}, {3.741362020005117*^9, 3.741362021747983*^9}, {
  3.7413631460186567`*^9, 3.741363184778266*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Bp", " ", "\[Sigma]\[Delta]", " ", 
      RowBox[{"f", "[", "s", "]"}]}], "+", 
     RowBox[{"Bm", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"f", "[", "s", "]"}]}], "]"}]}], "-", 
     RowBox[{"A", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"f", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"\[Beta]m", "[", "s", "]"}]}], 
  RowBox[{"\[Sigma]\[Delta]", " ", 
   RowBox[{"f", "[", "s", "]"}]}]]], "Output",
 CellChangeTimes->{
  3.741360431959037*^9, 3.7413606717566433`*^9, {3.7413609396419983`*^9, 
   3.7413609605045147`*^9}, {3.741361098937896*^9, 3.741361112653254*^9}, 
   3.741362026284399*^9, {3.7413631799651117`*^9, 3.741363187885099*^9}, {
   3.741541408159697*^9, 3.741541431500423*^9}, 3.741612649862269*^9, 
   3.7416311237114573`*^9, 3.741631195251965*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]c", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"Bp", "+", 
       RowBox[{"Bm", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", 
           RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "-", 
       RowBox[{"A", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", 
           RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[Beta]m", "[", "s", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", 
           RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "+", 
       RowBox[{"Bm", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", 
           RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]p", "[", "s_", "]"}], "=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"\[Alpha]c", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.74136221287379*^9, 3.741362272624235*^9}, {
  3.74136403299364*^9, 3.7413640352493773`*^9}, {3.741364405620727*^9, 
  3.741364496063037*^9}, {3.7413645342301807`*^9, 3.741364610636038*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"f", "[", "s", "]"}], "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "Bp", " ", "\[Sigma]\[Delta]", " ", 
     SuperscriptBox[
      RowBox[{"f", "[", "s", "]"}], "2"], " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}]}], "+", 
    RowBox[{"2", " ", "Bm", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"f", "[", "s", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}]}], "-", 
    RowBox[{"2", " ", "A", " ", 
     RowBox[{"f", "[", "s", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}]}], "-", 
    RowBox[{"Bm", " ", "\[Sigma]\[Delta]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"f", "[", "s", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}], "+", 
    RowBox[{"A", " ", "\[Sigma]\[Delta]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"f", "[", "s", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}], "+", 
    RowBox[{"Bm", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}], "+", 
    RowBox[{"2", " ", "A", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"f", "[", "s", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}], "-", 
    RowBox[{"A", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}], "+", 
    RowBox[{"2", " ", "Bm", " ", 
     RowBox[{"f", "[", "s", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7413622660924797`*^9, 3.7413622736525784`*^9}, 
   3.741364036072147*^9, 3.7413645844759607`*^9, 3.741364620609293*^9}]
}, Open  ]],

Cell["\<\
The above expression is awful, but we can use the fact that \[Alpha]m and \
\[Delta] are small and only keep the term they don\[CloseCurlyQuote]t appear \
in.\
\>", "Text",
 CellChangeTimes->{{3.74136579266928*^9, 3.741365865084756*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]c", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Beta]m", "[", "s", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"A", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{"Bm", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]p", "[", "s_", "]"}], "=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"\[Alpha]c", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.74136587467058*^9, 3.7413658814220867`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", "s", "]"}]}], "]"}]}], "+", 
     RowBox[{"Bm", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Sigma]\[Delta]", " ", 
     RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}], 
  RowBox[{"\[Sigma]\[Delta]", " ", 
   RowBox[{"f", "[", "s", "]"}]}]]], "Output",
 CellChangeTimes->{3.74136588416501*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]c", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
   FractionBox[
    RowBox[{"1", "+", 
     SuperscriptBox[
      RowBox[{"\[Alpha]c", "[", 
       RowBox[{"s", ",", "\[Delta]"}], "]"}], "2"]}], 
    RowBox[{"\[Beta]c", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]p", "[", "s_", "]"}], "=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"\[Gamma]c", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.74136637273256*^9, 3.741366421397057*^9}, {
  3.741366475079351*^9, 3.741366476805408*^9}, {3.741366540791255*^9, 
  3.7413665537344227`*^9}}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", 
   RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"UnitBox", "[", 
      FractionBox["\[Delta]", 
       RowBox[{"2", " ", "\[Sigma]\[Delta]"}]], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"A", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                FractionBox["\[Delta]", "2"]}], ")"}], " ", 
              RowBox[{"f", "[", "s", "]"}]}], "]"}]}], "+", 
           RowBox[{"Bm", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                FractionBox["\[Delta]", "2"]}], ")"}], " ", 
              RowBox[{"f", "[", "s", "]"}]}], "]"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"\[Beta]m", "[", "s", "]"}], "4"]}]}], ")"}]}], 
    RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
     RowBox[{"(", 
      RowBox[{"Bp", "+", 
       RowBox[{"Bm", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["\[Delta]", "2"]}], ")"}], " ", 
          RowBox[{"f", "[", "s", "]"}]}], "]"}]}], "-", 
       RowBox[{"A", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["\[Delta]", "2"]}], ")"}], " ", 
          RowBox[{"f", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{"\[Beta]m", "[", "s", "]"}]}]], 
   RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]], "Output",
 CellChangeTimes->{{3.741366409140882*^9, 3.741366422521071*^9}, 
   3.7413664778212433`*^9, 3.74136726157681*^9}]
}, Open  ]],

Cell["\<\
Now lets work with the \[Delta] dependent part of the beta function.\
\>", "Text",
 CellChangeTimes->{{3.741370346737627*^9, 3.7413703618540897`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]\[Delta]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Delta]", " ", 
      RowBox[{"\[Beta]m", "[", "s", "]"}]}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"s", ",", " ", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], 
      "-", 
      RowBox[{"A", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]p\[Delta]", "[", "s_", "]"}], "=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"\[Beta]\[Delta]", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.741370372103652*^9, 3.741370372792048*^9}, {
  3.741370646600157*^9, 3.7413707280530252`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"A", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "s", "]"}]}], "]"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"f", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Sigma]\[Delta]", " ", 
         RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
       RowBox[{"f", "[", "s", "]"}]}], "-", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"f", "[", "s", "]"}]}], "]"}]}], ")"}], " ", 
    RowBox[{"\[Beta]m", "[", "s", "]"}]}], 
   RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"f", "[", "s", "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.7413707335163593`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]\[Delta]", "[", 
   RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Beta]\[Delta]", "[", 
       RowBox[{"s", ",", "\[Delta]"}], "]"}], ",", "s"}], "]"}]}], "/", 
   "2"}]}]], "Input",
 CellChangeTimes->{{3.741371317256277*^9, 3.741371373463367*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", "\[Delta]", " ", 
     RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "A", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["\[Delta]", "2"]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["\[Delta]", "2"]}], ")"}], " ", 
          RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["f", "\[Prime]",
          MultilineFunction->None], "[", "s", "]"}]}], "+", 
       RowBox[{"2", " ", "c", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["\[Delta]", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["\[Delta]", "2"]}], ")"}], " ", 
          RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["f", "\[Prime]",
          MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[Delta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox["\[Delta]", "2"]}], ")"}], " ", 
            RowBox[{"f", "[", "s", "]"}]}], "]"}]}], ")"}]}], "-", 
       RowBox[{"A", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["\[Delta]", "2"]}], ")"}], " ", 
          RowBox[{"f", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\[Beta]m", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.741371373741418*^9}]
}, Open  ]],

Cell["\<\
With the failure to accomplish anything from the above, I decided to work \
with the case where the beam and all the chromatic components start with the \
same initial CS parameters and the centroid energy is matched.\
\>", "Text",
 CellChangeTimes->{{3.74154130521656*^9, 3.741541378428089*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["\[Delta]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
      "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["\[Delta]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
       "1"}], ")"}]}], "-", 
    RowBox[{
     FractionBox["\[Delta]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["\[Delta]", "2"]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", 
        RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"\[Beta]m", "[", "s", "]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"4", "+", 
        RowBox[{
         SuperscriptBox["\[Delta]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Delta]", "/", "2"}]}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}], "2"]}]}], 
       RowBox[{
        RowBox[{"2", " ", "\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"\[Theta]", "[", 
              RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
        "4"}]], "+", 
      RowBox[{
       RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", "\[Delta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[Alpha]m", "[", "s", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}], "+", 
      SuperscriptBox[
       RowBox[{"\[Alpha]m", "[", "s", "]"}], "2"]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7415413844416656`*^9, 3.741541398907016*^9}, {
   3.741541538825049*^9, 3.7415415882179823`*^9}, {3.741541629398691*^9, 
   3.7415416630313683`*^9}, {3.741541800825427*^9, 3.741541913164152*^9}, {
   3.74154249194702*^9, 3.741542492585644*^9}, {3.7415428248112507`*^9, 
   3.741543008811989*^9}, 3.7415430793330917`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]p", "[", "s_", "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
    RowBox[{
     RowBox[{"\[Beta]", "[", 
      RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
     RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
     RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.7415430996600637`*^9, {3.741543865430208*^9, 3.7415438701808558`*^9}, {
   3.741543989757751*^9, 3.741543995812505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"f", "[", "s", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"f", "[", "s", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]\[Delta]", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Sigma]\[Delta]", " ", 
           RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
         RowBox[{"f", "[", "s", "]"}]}], "-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Sigma]\[Delta]", " ", 
          RowBox[{"f", "[", "s", "]"}]}], "]"}]}], ")"}]}], 
     RowBox[{"\[Sigma]\[Delta]", " ", 
      SuperscriptBox[
       RowBox[{"f", "[", "s", "]"}], "2"]}]]}], ")"}], " ", 
  RowBox[{"\[Beta]m", "[", "s", "]"}]}]], "Output",
 CellChangeTimes->{3.741543109126264*^9, 3.7415433821712637`*^9, 
  3.741543881060177*^9, 3.741543997292676*^9, 3.7416126634308558`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]p", "[", "s_", "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
    RowBox[{
     RowBox[{"\[Alpha]", "[", 
      RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
     RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
     RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7415441342525682`*^9, 3.7415441465649967`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", "\[Sigma]\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"f", "[", "s", "]"}], "3"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", "\[Sigma]\[Delta]", " ", 
     SuperscriptBox[
      RowBox[{"f", "[", "s", "]"}], "3"], " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"f", "[", "s", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{
           SuperscriptBox["\[Sigma]\[Delta]", "2"], " ", 
           SuperscriptBox[
            RowBox[{"f", "[", "s", "]"}], "2"]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", "s", "]"}], " ", 
           RowBox[{"\[Alpha]m", "[", "s", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
    
    RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"f", "[", "s", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", "s", "]"}]}], "]"}]}], " ", 
        RowBox[{"f", "[", "s", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"f", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"f", "[", "s", "]"}], " ", 
           RowBox[{"\[Alpha]m", "[", "s", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.741544137156292*^9, 3.741544153780455*^9}, 
   3.7416126714918003`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"\[Gamma]", "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Delta]", "2"], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", 
           RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}], "2"]}]}], ")"}], 
    " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.741544210360257*^9, 3.74154421657403*^9}, {
  3.741544439047517*^9, 3.7415444540537167`*^9}, {3.741545001421318*^9, 
  3.741545043577394*^9}, {3.741545549399413*^9, 3.741545611627544*^9}, {
  3.741545657660591*^9, 3.741545663939096*^9}, {3.741548469281258*^9, 
  3.741548473711001*^9}, {3.741612696152403*^9, 3.741612698408231*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"192", " ", "\[Sigma]\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"f", "[", "s", "]"}], "3"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Sigma]\[Delta]"}], ")"}], " ", 
         RowBox[{"f", "[", "s", "]"}]}], "]"}], "-", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"4", " ", 
          RowBox[{"f", "[", "s", "]"}]}], "-", 
         RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
          RowBox[{"f", "[", "s", "]"}]}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
     RowBox[{"f", "[", "s", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Sigma]\[Delta]"}], ")"}], " ", 
            RowBox[{"f", "[", "s", "]"}]}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "\[Sigma]\[Delta]"}], ")"}], " ", 
            RowBox[{"f", "[", "s", "]"}]}], "]"}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"24", "+", 
          SuperscriptBox["\[Sigma]\[Delta]", "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"f", "[", "s", "]"}], "2"]}], "+", 
       RowBox[{"3", " ", "\[Sigma]\[Delta]", " ", 
        RowBox[{"f", "[", "s", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "\[Sigma]\[Delta]"}], ")"}], " ", 
             RowBox[{"f", "[", "s", "]"}]}], "]"}]}], "+", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"4", " ", 
             RowBox[{"f", "[", "s", "]"}]}], "-", 
            RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
             RowBox[{"f", "[", "s", "]"}]}]}], "]"}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.74154422452067*^9, 3.7415449880060987`*^9, 
  3.7415451429140663`*^9, 3.741545626351808*^9, 3.741545753239168*^9, 
  3.741548482460293*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The general case for an arbitrary plasma", "Subsubsection",
 CellChangeTimes->{{3.74169936109554*^9, 3.741699372990107*^9}}],

Cell["\<\
The \[Alpha] function for an arbitrary off energy beam in an adiabatic ramp \
is given by taking the derivative of \[Beta](\[Delta]).\
\>", "Text",
 CellChangeTimes->{{3.7416171985568933`*^9, 3.7416172601067257`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", "s_", "]"}], "=", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "0", "s"], 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Beta]m", "[", "x", "]"}]], " ", 
     RowBox[{"\[DifferentialD]", "x"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox["\[Delta]", "2"]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", "s", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]m", "'"}], "[", "s_", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{"\[Alpha]m", "[", "s", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["\[Delta]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"\[Psi]", "[", 
               RowBox[{"s", ",", " ", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}],
          "-", 
         RowBox[{"A", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"\[Psi]", "[", 
             RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"Bm", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "-", 
      RowBox[{"A", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "+", "Bp"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "[", 
   RowBox[{"s_", ",", "\[Delta]_"}], "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Beta]", "[", 
        RowBox[{"s", ",", "\[Delta]"}], "]"}], ",", "s"}], "]"}]}], "/", 
    "2"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.741617262292301*^9, 3.7416172734989557`*^9}, {
   3.741617935876294*^9, 3.741618296888528*^9}, 3.741631084274744*^9, 
   3.741631169923356*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Bp"}], "+", 
       RowBox[{"c", " ", "\[Delta]"}]}], ")"}], " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Delta]"}], ")"}], " ", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "s"], 
        RowBox[{
         FractionBox["1", 
          RowBox[{"\[Beta]m", "[", "x", "]"}]], 
         RowBox[{"\[DifferentialD]", "x"}]}]}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Delta]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Bm"}], "-", 
          RowBox[{"c", " ", "\[Delta]"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "A", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "\[Delta]"}], ")"}], " ", 
        RowBox[{"\[Alpha]m", "[", "s", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Delta]"}], ")"}], " ", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "s"], 
        RowBox[{
         FractionBox["1", 
          RowBox[{"\[Beta]m", "[", "x", "]"}]], 
         RowBox[{"\[DifferentialD]", "x"}]}]}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "A"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "4"}], "+", 
          SuperscriptBox["\[Delta]", "2"]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "Bm"}], "-", 
          RowBox[{"2", " ", "c", " ", "\[Delta]"}]}], ")"}], " ", 
        RowBox[{"\[Alpha]m", "[", "s", "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.741618055567919*^9, 3.74161821382631*^9, {3.74161825761836*^9, 
   3.741618298442466*^9}, 3.7416310988359337`*^9, 3.741631129914442*^9, 
   3.7416311853389263`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["\[Delta]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"\[Psi]", "[", 
              RowBox[{"s", ",", " ", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], 
        "-", 
        RowBox[{"A", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Psi]", "[", 
            RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}], "+", 
     
     RowBox[{"Bm", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "-", 
     RowBox[{"A", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "+", "Bp"}], ",", 
    "s"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.741620533703947*^9, 3.741620554013214*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", "\[Delta]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "\[Delta]"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Delta]"}], ")"}], " ", 
        RowBox[{
         SubsuperscriptBox["\[Integral]", "0", "s"], 
         RowBox[{
          FractionBox["1", 
           RowBox[{"\[Beta]m", "[", "x", "]"}]], 
          RowBox[{"\[DifferentialD]", "x"}]}]}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "Bm"}], "+", 
        RowBox[{"c", " ", "\[Delta]"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Delta]"}], ")"}], " ", 
        RowBox[{
         SubsuperscriptBox["\[Integral]", "0", "s"], 
         RowBox[{
          FractionBox["1", 
           RowBox[{"\[Beta]m", "[", "x", "]"}]], 
          RowBox[{"\[DifferentialD]", "x"}]}]}]}], "]"}]}]}], ")"}]}], 
  RowBox[{"2", " ", 
   RowBox[{"\[Beta]m", "[", "s", "]"}]}]]], "Output",
 CellChangeTimes->{3.741620555039578*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Theta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]p", "[", "s_", "]"}], "=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.741630068800542*^9, 3.741630085131795*^9}, {
  3.7416310591301107`*^9, 3.741631064897778*^9}, {3.741631161994109*^9, 
  3.7416311656819067`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]], 
  RowBox[{
   RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "-", 
     RowBox[{"A", " ", "\[Sigma]\[Delta]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
     RowBox[{"c", " ", "\[Sigma]\[Delta]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
     RowBox[{"2", " ", "Bm", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"\[Theta]", "[", "s", "]"}]}], "-", 
     RowBox[{"2", " ", "A", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
     RowBox[{"2", " ", "Bp", " ", "\[Sigma]\[Delta]", " ", 
      SuperscriptBox[
       RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7416310361398373`*^9, {3.741631066888658*^9, 3.7416311027234793`*^9}, 
   3.741631132886862*^9, {3.741631188003983*^9, 3.7416312042042007`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "%93", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]], 
  RowBox[{
   RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "-", 
        RowBox[{"c", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", "\[Sigma]\[Delta]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "A", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}]}], "+", 
        
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "A"}], " ", "\[Sigma]\[Delta]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", "Bm", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}]}]}], 
       ")"}], " ", 
      RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
     RowBox[{"2", " ", "Bp", " ", "\[Sigma]\[Delta]", " ", 
      SuperscriptBox[
       RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7416312068977633`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P\[Alpha]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Delta]", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{"c", "+", "Bm"}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
    RowBox[{"A", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
    RowBox[{"Bm", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Psi]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  SuperscriptBox["P\[Alpha]", "2"], "]"}]}], "Input",
 CellChangeTimes->{{3.7416361173175993`*^9, 3.741636165663006*^9}, {
  3.741636216000538*^9, 3.741636266625646*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["A", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Psi]"}], "]"}], "2"]}], "+", 
  RowBox[{"2", " ", "A", " ", "Bm", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "-", 
  RowBox[{"A", " ", "Bm", " ", "\[Delta]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "-", 
  RowBox[{"A", " ", "c", " ", "\[Delta]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Psi]"}], "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Psi]"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["Bm", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Psi]"}], "]"}], "2"]}], "-", 
  RowBox[{
   SuperscriptBox["Bm", "2"], " ", "\[Delta]", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Psi]"}], "]"}], "2"]}], "-", 
  RowBox[{"Bm", " ", "c", " ", "\[Delta]", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Psi]"}], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["Bm", "2"], " ", 
   SuperscriptBox["\[Delta]", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Psi]"}], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "Bm", " ", "c", " ", 
   SuperscriptBox["\[Delta]", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Psi]"}], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["\[Delta]", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Psi]"}], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.741636231763699*^9, 3.741636267592761*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matched beam, first order in \[Delta]", "Subsubsection",
 CellChangeTimes->{{3.741699269274828*^9, 3.741699285456663*^9}}],

Cell["\<\
We have all the CS parameters to first order in \[Delta] for a matched beam, \
now to find the projected CS parameters.\
\>", "Text",
 CellChangeTimes->{{3.741699289760057*^9, 3.74169931966118*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox["\[Delta]", "2"]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", "s", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", "\[Delta]_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", "\[Sigma]\[Delta]"}]], 
    RowBox[{"UnitBox", "[", 
     RowBox[{"\[Delta]", "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "\[Sigma]\[Delta]"}], ")"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["\[Delta]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Psi]", "[", 
            RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
      "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[Alpha]m", "[", "s", "]"}], 
      RowBox[{"\[Beta]m", "[", "s", "]"}]], " ", 
     RowBox[{"\[Beta]", "[", 
      RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["\[Delta]", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Psi]", "[", 
        RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"\[Beta]m", "[", "s", "]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Delta]", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Psi]", "[", 
            RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
      "1"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7416993882051573`*^9, 3.7416994222573977`*^9}, {
  3.741699732808916*^9, 3.7416998614504147`*^9}, {3.741699920055789*^9, 
  3.741699935808597*^9}, {3.741700139455826*^9, 3.741700159223114*^9}, {
  3.7417001911191196`*^9, 3.7417001922548018`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]p", "[", "s_", "]"}], "=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.741700167814475*^9, 3.741700172454482*^9}, {
  3.741700257636982*^9, 3.7417002632917423`*^9}, {3.741700296820034*^9, 
  3.741700298738635*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
     RowBox[{"\[Sigma]\[Delta]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Sigma]\[Delta]", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
      RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
     RowBox[{"\[Sigma]\[Delta]", " ", 
      SuperscriptBox[
       RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]}], ")"}]}], 
  RowBox[{"\[Sigma]\[Delta]", " ", 
   SuperscriptBox[
    RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]]], "Output",
 CellChangeTimes->{
  3.7417001741846647`*^9, 3.741700209429443*^9, {3.741700264654022*^9, 
   3.741700299859757*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]p", "[", "s_", "]"}], "=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"\[Alpha]", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.741700217461165*^9, 3.7417002216290617`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}]}], "-", 
    RowBox[{"\[Sigma]\[Delta]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
    RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
    RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.741700227073237*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]p", "[", "s_", "]"}], "=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", 
    RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], " ", 
   RowBox[{
    RowBox[{"\[Gamma]", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], " ", 
    RowBox[{"n", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"\[DifferentialD]", "\[Delta]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.741700237908341*^9, 3.741700288203218*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Sigma]\[Delta]", " ", 
      RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "-", 
   RowBox[{"\[Sigma]\[Delta]", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Sigma]\[Delta]", " ", 
      RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
    RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
   RowBox[{"\[Sigma]\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]}], 
  RowBox[{"\[Sigma]\[Delta]", " ", 
   RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.7417002461922493`*^9, 3.7417002907542*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]p", "[", "s", "]"}], " ", 
    RowBox[{"\[Gamma]p", "[", "s", "]"}]}], "-", 
   SuperscriptBox[
    RowBox[{"\[Alpha]p", "[", "s", "]"}], "2"]}], "]"}]], "Input",
 CellChangeTimes->{{3.7417003033253183`*^9, 3.7417003208741713`*^9}, {
  3.741700372217456*^9, 3.741700377656917*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     SuperscriptBox["\[Sigma]\[Delta]", "2"], " ", 
     SuperscriptBox[
      RowBox[{"\[Theta]", "[", "s", "]"}], "4"]}]], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Sigma]\[Delta]", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
            RowBox[{"\[Alpha]m", "[", "s", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"\[Sigma]\[Delta]", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Sigma]\[Delta]", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
            RowBox[{"\[Alpha]m", "[", "s", "]"}]}]}], ")"}], " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
        RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
         RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]}], ")"}], "2"], "-", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Sigma]\[Delta]", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
        RowBox[{"\[Sigma]\[Delta]", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], "+", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Sigma]\[Delta]", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
        RowBox[{"\[Sigma]\[Delta]", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], "+", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.741700312944048*^9, 3.741700321680394*^9}, 
   3.741700384609002*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]p", "[", "s_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Sigma]\[Delta]", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "-", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Sigma]\[Delta]", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       SuperscriptBox[
        RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]}], 
     RowBox[{"\[Sigma]\[Delta]", " ", 
      RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]], "+", 
    RowBox[{"2", " ", 
     FractionBox[
      RowBox[{"\[Beta]m", "[", "s", "]"}], 
      RowBox[{"\[Alpha]m", "[", "s", "]"}]], " ", 
     RowBox[{"\[Alpha]p", "[", "s", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]p", "[", "s", "]"}], " ", 
    RowBox[{"\[Gamma]p", "[", "s", "]"}]}], "-", 
   RowBox[{"\[Alpha]p", "[", "s", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.74171266043589*^9, 3.7417127556355143`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}]}], "+", 
    RowBox[{"\[Sigma]\[Delta]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "-", 
    RowBox[{"\[Sigma]\[Delta]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "-", 
    RowBox[{"2", " ", "\[Sigma]\[Delta]", " ", 
     RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Sigma]\[Delta]", " ", 
       RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Sigma]\[Delta]", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
        RowBox[{"\[Sigma]\[Delta]", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}]}], "+", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"\[Beta]m", "[", "s", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Sigma]\[Delta]", " ", 
             RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], "-", 
           RowBox[{"\[Sigma]\[Delta]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
            RowBox[{"\[Theta]", "[", "s", "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"\[Alpha]m", "[", "s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}]}], ")"}]}], "+", 
           RowBox[{"\[Sigma]\[Delta]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Sigma]\[Delta]", " ", 
              RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}]}], ")"}], " ", 
            RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
           RowBox[{"\[Sigma]\[Delta]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"\[Theta]", "[", "s", "]"}], "2"]}]}], ")"}]}]}], 
       ")"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.74171278480877*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chromatic amplitude function", "Subsubsection",
 CellChangeTimes->{{3.742578281856494*^9, 3.742578301774865*^9}}],

Cell["\<\
We are assuming \[Beta](\[Delta]) is approximately linear in \[Delta] so we \
can expand the trig functions in delta.\
\>", "Text",
 CellChangeTimes->{{3.742578441358653*^9, 3.742578482190639*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", ",", " ", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.742578305633909*^9, 3.742578398432453*^9}, {
  3.7425785060725737`*^9, 3.7425785061995783`*^9}, {3.742657564699088*^9, 
  3.7426575648595657`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Theta]"}], "]"}], "+", 
   RowBox[{"\[Theta]", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", "\[Delta]"}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Theta]", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ")"}], " ", 
    SuperscriptBox["\[Delta]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Delta]", "]"}], "3"],
    SeriesData[$CellContext`\[Delta], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Delta], 0, {
    Cos[2 $CellContext`\[Theta]], $CellContext`\[Theta] 
    Sin[2 $CellContext`\[Theta]], Rational[-1, 2] $CellContext`\[Theta]^2 
    Cos[2 $CellContext`\[Theta]]}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.742578375390253*^9, 3.742578399433856*^9}, 
   3.742578506905787*^9, 3.742657586990699*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", ",", " ", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.742578510207288*^9, 3.742578514307987*^9}, {
  3.74265757005064*^9, 3.7426575702111607`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Theta]"}], "]"}], "-", 
   RowBox[{"\[Theta]", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", "\[Delta]"}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Theta]", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ")"}], " ", 
    SuperscriptBox["\[Delta]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Delta]", "]"}], "3"],
    SeriesData[$CellContext`\[Delta], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Delta], 0, {
    Sin[2 $CellContext`\[Theta]], -$CellContext`\[Theta] 
    Cos[2 $CellContext`\[Theta]], Rational[-1, 2] $CellContext`\[Theta]^2 
    Sin[2 $CellContext`\[Theta]]}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.742578515631325*^9, 3.7426575898091717`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", "\[Delta]_", "]"}], ":=", 
   RowBox[{"\[Beta]m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["\[Delta]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], 
             "]"}]}], ")"}]}], "-", 
         RowBox[{"A", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], 
           "]"}]}]}], ")"}]}], "+", 
      RowBox[{"Bm", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], 
        "]"}]}], "-", 
      RowBox[{"A", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], 
        "]"}]}], "+", "Bp"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]1", "[", "\[Delta]_", "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"\[Beta]", "[", "\[Delta]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Delta]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]1", "'"}], "[", "0", "]"}]}], "Input",
 CellChangeTimes->{{3.742583863621333*^9, 3.742584020528819*^9}, {
  3.742584069723598*^9, 3.742584095169392*^9}, {3.742585462789639*^9, 
  3.7425854794338408`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "\[Beta]m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "Bp"}], "+", 
    RowBox[{"c", " ", "\[Delta]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Bm"}], "-", 
       RowBox[{"c", " ", "\[Delta]"}], "+", 
       RowBox[{"2", " ", "A", " ", "\[Delta]", " ", "\[Theta]"}]}], ")"}], 
     " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "\[Delta]"}], ")"}]}], "-", 
       RowBox[{"2", " ", "Bm", " ", "\[Delta]", " ", "\[Theta]"}]}], ")"}], 
     " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.742583998645184*^9, 3.7425840215103617`*^9}, {
   3.74258407414404*^9, 3.742584096195025*^9}, 3.7425854818558826`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "\[Beta]m", " ", 
  RowBox[{"(", 
   RowBox[{"c", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "c"}], "+", 
       RowBox[{"2", " ", "A", " ", "\[Theta]"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"A", "-", 
       RowBox[{"2", " ", "Bm", " ", "\[Theta]"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.742583998645184*^9, 3.7425840215103617`*^9}, {
   3.74258407414404*^9, 3.742584096195025*^9}, 3.7425854818568707`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", "[", "\[Delta]_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["\[Alpha]m", "\[Beta]m"], " ", 
     RowBox[{"\[Beta]", "[", "\[Delta]", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["\[Delta]", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["\[Delta]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], 
            "]"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{"A", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], 
         "]"}]}], "+", 
       RowBox[{"Bm", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Delta]", "/", "2"}]}], ")"}], " ", "\[Theta]"}], 
         "]"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "[", "\[Delta]_", "]"}], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", "\[Delta]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Delta]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "'"}], "[", "0", "]"}]}], "Input",
 CellChangeTimes->{{3.7425861714591618`*^9, 3.74258634169681*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"A", "+", 
     RowBox[{"Bm", " ", "\[Alpha]m"}], "-", 
     FractionBox[
      RowBox[{"c", " ", "\[Alpha]m", " ", "\[Delta]"}], "2"], "-", 
     RowBox[{"Bm", " ", "\[Delta]", " ", "\[Theta]"}], "+", 
     RowBox[{"A", " ", "\[Alpha]m", " ", "\[Delta]", " ", "\[Theta]"}]}], 
    ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Alpha]m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "Bp"}], "+", 
        RowBox[{"c", " ", "\[Delta]"}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "\[Delta]"}], "+", 
        RowBox[{"A", " ", "\[Alpha]m", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Delta]"}], ")"}]}], "-", 
        RowBox[{"2", " ", "A", " ", "\[Delta]", " ", "\[Theta]"}], "+", 
        RowBox[{"Bm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Delta]", "-", 
           RowBox[{
           "2", " ", "\[Alpha]m", " ", "\[Delta]", " ", "\[Theta]"}]}], 
          ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.742586343425321*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"c", " ", "\[Alpha]m"}], "2"]}], "-", 
     RowBox[{"Bm", " ", "\[Theta]"}], "+", 
     RowBox[{"A", " ", "\[Alpha]m", " ", "\[Theta]"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c", " ", "\[Alpha]m"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c", "+", 
        RowBox[{"A", " ", "\[Alpha]m"}], "-", 
        RowBox[{"2", " ", "A", " ", "\[Theta]"}], "+", 
        RowBox[{"Bm", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "\[Alpha]m", " ", "\[Theta]"}]}], ")"}]}]}], 
       ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7425863434262037`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"W2", "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Alpha]1", "'"}], "[", "0", "]"}], "-", 
      RowBox[{
       FractionBox["\[Alpha]m", "\[Beta]m"], " ", 
       RowBox[{
        RowBox[{"\[Beta]1", "'"}], "[", "0", "]"}]}]}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Beta]m"], " ", 
      RowBox[{
       RowBox[{"\[Beta]1", "'"}], "[", "0", "]"}]}], ")"}], "2"]}]}]], "Input",\

 CellChangeTimes->{{3.742586705254006*^9, 3.742586797360181*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "c"}], "+", 
         RowBox[{"2", " ", "A", " ", "\[Theta]"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"A", "-", 
         RowBox[{"2", " ", "Bm", " ", "\[Theta]"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], "2"]}], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"c", " ", "\[Alpha]m"}], "2"]}], "-", 
        RowBox[{"Bm", " ", "\[Theta]"}], "+", 
        RowBox[{"A", " ", "\[Alpha]m", " ", "\[Theta]"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "\[Alpha]m", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c"}], "+", 
           RowBox[{"2", " ", "A", " ", "\[Theta]"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"A", "-", 
           RowBox[{"2", " ", "Bm", " ", "\[Theta]"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "\[Alpha]m"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "+", 
           RowBox[{"A", " ", "\[Alpha]m"}], "-", 
           RowBox[{"2", " ", "A", " ", "\[Theta]"}], "+", 
           RowBox[{"Bm", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "\[Alpha]m", " ", "\[Theta]"}]}], ")"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]}], ")"}], 
   "2"]}]], "Output",
 CellChangeTimes->{3.742586799645986*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "W2", "]"}]], "Input",
 CellChangeTimes->{{3.742586819889174*^9, 3.742586820554474*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Bm", " ", "\[Theta]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Bm", "+", "c", "-", 
          RowBox[{"2", " ", "A", " ", "\[Theta]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "c"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"c", "-", 
          RowBox[{"2", " ", "A", " ", "\[Theta]"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A", "-", 
          RowBox[{"2", " ", "Bm", " ", "\[Theta]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], "2"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.742586802754808*^9, 3.7425868234648523`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbative chromaticity", "Subsubsection",
 CellChangeTimes->{{3.7426696000580597`*^9, 3.742669604414609*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", "\[Delta]"}], 
    RowBox[{
     RowBox[{"\[Gamma]0", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Delta]"}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Alpha]0", " ", "I0"}], "-", 
        RowBox[{"\[Gamma]0", " ", "I1"}]}], ")"}]}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", ",", "0", ",", " ", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.742669607120823*^9, 3.742669648762569*^9}, {
  3.742669691482582*^9, 3.742669693458729*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "I0", " ", "\[Alpha]0"}], "+", "\[Gamma]0", "-", 
     RowBox[{"2", " ", "I1", " ", "\[Gamma]0"}]}]], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"I0", " ", "\[Alpha]0"}], "-", 
       RowBox[{"I1", " ", "\[Gamma]0"}]}], ")"}], " ", "\[Delta]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "I0", " ", "\[Alpha]0"}], "+", "\[Gamma]0", "-", 
       RowBox[{"2", " ", "I1", " ", "\[Gamma]0"}]}], ")"}], "2"]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Delta]", "]"}], "2"],
    SeriesData[$CellContext`\[Delta], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Delta], 
   0, {(2 $CellContext`I0 $CellContext`\[Alpha]0 + $CellContext`\[Gamma]0 - 
     2 $CellContext`I1 $CellContext`\[Gamma]0)^(-1), 
    2 (2 $CellContext`I0 $CellContext`\[Alpha]0 + $CellContext`\[Gamma]0 - 
      2 $CellContext`I1 $CellContext`\[Gamma]0)^(-2) ($CellContext`I0 \
$CellContext`\[Alpha]0 - $CellContext`I1 $CellContext`\[Gamma]0)}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.742669695353529*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 391, 8, 56, "Input"],
Cell[952, 30, 252, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[1229, 39, 2010, 55, 159, "Input"],
Cell[3242, 96, 1169, 29, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4448, 130, 1832, 51, 76, "Input"],
Cell[6283, 183, 3382, 89, 82, "Output"]
}, Open  ]],
Cell[9680, 275, 247, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[9952, 284, 1069, 31, 76, "Input"],
Cell[11024, 317, 647, 20, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11708, 342, 901, 24, 104, "Input"],
Cell[12612, 368, 1887, 52, 74, "Output"]
}, Open  ]],
Cell[14514, 423, 160, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[14699, 430, 1245, 36, 94, "Input"],
Cell[15947, 468, 951, 28, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16935, 501, 374, 11, 34, "Input"],
Cell[17312, 514, 2106, 61, 49, "Output"]
}, Open  ]],
Cell[19433, 578, 306, 5, 33, "Text"],
Cell[19742, 585, 3597, 105, 148, "Input"],
Cell[CellGroupData[{
Cell[23364, 694, 565, 14, 50, "Input"],
Cell[23932, 710, 945, 25, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24914, 740, 492, 12, 50, "Input"],
Cell[25409, 754, 2103, 62, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27549, 821, 1029, 24, 75, "Input"],
Cell[28581, 847, 2401, 66, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31019, 918, 130, 1, 35, "Subsubsection"],
Cell[31152, 921, 227, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[31404, 929, 2473, 75, 187, "Input"],
Cell[33880, 1006, 2168, 67, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36085, 1078, 1123, 34, 52, "Input"],
Cell[37211, 1114, 1300, 41, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38548, 1160, 609, 14, 73, "Input"],
Cell[39160, 1176, 2445, 61, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41642, 1242, 84, 2, 32, "Input"],
Cell[41729, 1246, 2264, 62, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44030, 1313, 708, 20, 83, "Input"],
Cell[44741, 1335, 1918, 56, 49, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46708, 1397, 128, 1, 35, "Subsubsection"],
Cell[46839, 1400, 208, 4, 33, "Text"],
Cell[47050, 1406, 2534, 78, 230, "Input"],
Cell[CellGroupData[{
Cell[49609, 1488, 539, 13, 50, "Input"],
Cell[50151, 1503, 1196, 32, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51384, 1540, 443, 11, 50, "Input"],
Cell[51830, 1553, 1795, 46, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53662, 1604, 441, 11, 50, "Input"],
Cell[54106, 1617, 1040, 27, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55183, 1649, 369, 9, 41, "Input"],
Cell[55555, 1660, 3779, 98, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59371, 1763, 1625, 42, 86, "Input"],
Cell[60999, 1807, 5296, 135, 142, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66344, 1948, 119, 1, 35, "Subsubsection"],
Cell[66466, 1951, 207, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[66698, 1959, 484, 12, 34, "Input"],
Cell[67185, 1973, 1027, 27, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68249, 2005, 430, 11, 34, "Input"],
Cell[68682, 2018, 980, 26, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69699, 2049, 1913, 55, 98, "Input"],
Cell[71615, 2106, 949, 27, 49, "Output"],
Cell[72567, 2135, 690, 19, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73294, 2159, 1978, 58, 100, "Input"],
Cell[75275, 2219, 1357, 39, 49, "Output"],
Cell[76635, 2260, 943, 29, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77615, 2294, 582, 19, 56, "Input"],
Cell[78200, 2315, 2260, 68, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80497, 2388, 153, 3, 32, "Input"],
Cell[80653, 2393, 1146, 34, 49, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81848, 2433, 118, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[81991, 2438, 600, 17, 56, "Input"],
Cell[82594, 2457, 1236, 30, 85, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

