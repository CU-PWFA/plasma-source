(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17835,        527]
NotebookOptionsPosition[     17256,        502]
NotebookOutlinePosition[     17597,        517]
CellTagsIndexPosition[     17554,        514]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Non-adiabatic by assumed solution", "Subsubsection",
 CellChangeTimes->{{3.747405172806712*^9, 3.747405183742618*^9}}],

Cell["\<\
Assume a solution with the same form as the adiabatic solution.\
\>", "Text",
 CellChangeTimes->{{3.747405186685625*^9, 3.747405195157403*^9}, {
  3.747405293809392*^9, 3.747405303041143*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", "s_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c0", "[", "s", "]"}], "+", 
      RowBox[{
       RowBox[{"c1", "[", "s", "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"c2", "[", "s", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"\[Beta]", "'"}], "[", "s", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"\[Beta]", "''"}], "[", "s", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.747405457228877*^9, 3.747405523340242*^9}, {
  3.747405626641891*^9, 3.7474056667533827`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c0", "[", "s", "]"}], "+", 
     RowBox[{
      RowBox[{"c1", "[", "s", "]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"c2", "[", "s", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Beta]m", "\[Prime]",
     MultilineFunction->None], "[", "s", "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["c0", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c2", "\[Prime]",
          MultilineFunction->None], "[", "s", "]"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"c1", "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c1", "\[Prime]",
          MultilineFunction->None], "[", "s", "]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"c2", "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.747405630527248*^9, 3.747405667974345*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{
    SuperscriptBox["c0", "\[Prime]",
     MultilineFunction->None], "[", "s", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Beta]m", "\[Prime]",
     MultilineFunction->None], "[", "s", "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
   RowBox[{
    SuperscriptBox["c0", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "s", "]"}]}], "+", 
  RowBox[{
   RowBox[{"c0", "[", "s", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Beta]m", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "s", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{
       SuperscriptBox["c2", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Beta]m", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}]}], "-", 
     RowBox[{"4", " ", 
      RowBox[{"c1", "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Beta]m", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{"c2", "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Beta]m", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["c1", "\[Prime]",
             MultilineFunction->None], "[", "s", "]"}], "+", 
           RowBox[{
            RowBox[{"c2", "[", "s", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["c2", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "s", "]"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"c1", "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]}], ")"}]}], 
  "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{
       SuperscriptBox["c1", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Beta]m", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"c2", "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Beta]m", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{"c1", "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Beta]m", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["c2", "\[Prime]",
             MultilineFunction->None], "[", "s", "]"}], "-", 
           RowBox[{
            RowBox[{"c1", "[", "s", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["c1", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "s", "]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"c2", "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.747405630527248*^9, 3.7474056687875137`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{
     RowBox[{"\[Beta]", "''"}], "[", "s", "]"}]}], "+", 
   FractionBox[
    RowBox[{"\[Beta]", "[", "s", "]"}], 
    SuperscriptBox[
     RowBox[{"\[Beta]m", "[", "s", "]"}], "2"]], "-", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"\[Beta]", "[", "s", "]"}]], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{
          RowBox[{"\[Beta]", "'"}], "[", "s", "]"}]}], ")"}], "2"]}], 
     ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.747405702771545*^9, 3.7474057619290247`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"c0", "[", "s", "]"}], "+", 
    RowBox[{
     RowBox[{"c1", "[", "s", "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c2", "[", "s", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], 
   RowBox[{"\[Beta]m", "[", "s", "]"}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c0", "[", "s", "]"}], "+", 
            RowBox[{
             RowBox[{"c1", "[", "s", "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"c2", "[", "s", "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["\[Beta]m", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c0", "\[Prime]",
              MultilineFunction->None], "[", "s", "]"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["c2", "\[Prime]",
                 MultilineFunction->None], "[", "s", "]"}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"c1", "[", "s", "]"}], " ", 
                RowBox[{
                 SuperscriptBox["\[Theta]", "\[Prime]",
                  MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["c1", "\[Prime]",
                 MultilineFunction->None], "[", "s", "]"}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"c2", "[", "s", "]"}], " ", 
                RowBox[{
                 SuperscriptBox["\[Theta]", "\[Prime]",
                  MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], "2"]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c0", "[", "s", "]"}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "s", "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"c2", "[", "s", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{"\[Beta]m", "[", "s", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{
       SuperscriptBox["c0", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Beta]m", "\[Prime]",
        MultilineFunction->None], "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["c0", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{"c0", "[", "s", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Beta]m", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{
          SuperscriptBox["c2", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]m", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"c1", "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]m", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}], "+", 
        RowBox[{
         RowBox[{"c2", "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]m", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "[", "s", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["c1", "\[Prime]",
                MultilineFunction->None], "[", "s", "]"}], "+", 
              RowBox[{
               RowBox[{"c2", "[", "s", "]"}], " ", 
               RowBox[{
                SuperscriptBox["\[Theta]", "\[Prime]",
                 MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "+", 
           
           RowBox[{
            SuperscriptBox["c2", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "s", "]"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"c1", "[", "s", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{
          SuperscriptBox["c1", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]m", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"c2", "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]m", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}], "+", 
        RowBox[{
         RowBox[{"c1", "[", "s", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]m", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "[", "s", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["c2", "\[Prime]",
                MultilineFunction->None], "[", "s", "]"}], "-", 
              RowBox[{
               RowBox[{"c1", "[", "s", "]"}], " ", 
               RowBox[{
                SuperscriptBox["\[Theta]", "\[Prime]",
                 MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "+", 
           
           RowBox[{
            SuperscriptBox["c1", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "s", "]"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"c2", "[", "s", "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.74740575181246*^9, 3.747405780998996*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1311, 1028},
WindowMargins->{{544, Automatic}, {0, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 124, 1, 35, "Subsubsection"],
Cell[707, 25, 202, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[934, 33, 954, 27, 78, "Input"],
Cell[1891, 62, 1843, 55, 36, "Output"],
Cell[3737, 119, 4484, 126, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8258, 250, 714, 23, 57, "Input"],
Cell[8975, 275, 8253, 223, 217, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

