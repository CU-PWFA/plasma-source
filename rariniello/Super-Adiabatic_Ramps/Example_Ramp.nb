(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    124433,       3056]
NotebookOptionsPosition[    121151,       2948]
NotebookOutlinePosition[    121491,       2963]
CellTagsIndexPosition[    121448,       2960]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", ">", "0"}], ",", 
     RowBox[{"\[Sigma]", ">", "0"}], ",", 
     RowBox[{"k\[Beta]", ">", "0"}], ",", 
     RowBox[{"s", ">", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.746377459987852*^9, 3.746377462403872*^9}, 
   3.7465401975563726`*^9, {3.746540229124446*^9, 3.746540240004202*^9}, 
   3.7465446371637383`*^9, {3.746557373941133*^9, 3.746557377089913*^9}}],

Cell[CellGroupData[{

Cell["Example Ramp for the Paper", "Subsubsection",
 CellChangeTimes->{{3.746376866901692*^9, 3.746376875762908*^9}}],

Cell["\<\
The ramp has an adiabatic section and a perturbative section, the plasma \
density profiles in each section are given by\
\>", "Text",
 CellChangeTimes->{{3.7463768787651854`*^9, 3.746376912096306*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]a", "[", "s_", "]"}], ":=", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", " ", "s"}], ")"}], "2"]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]p", "[", "s_", "]"}], ":=", 
   RowBox[{"\[Eta]t", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s", "-", "st"}], ")"}], "2"]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", "[", "s_", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]a", "[", "s", "]"}], ",", 
        RowBox[{"s", ">", "st"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]p", "[", "s", "]"}], ",", 
        RowBox[{"s", "\[LessEqual]", "st"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st", ":=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "a"]}], 
    SqrtBox[
     RowBox[{
      FractionBox["1", "\[Eta]t"], "-", "1"}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", ":=", 
   RowBox[{"2", " ", "\[Alpha]m"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7463769161931458`*^9, 3.746377165933386*^9}, {
  3.746379392918494*^9, 3.746379397110096*^9}}],

Cell["\<\
We need to choose the perturbative region length to match our target beam \
into the adiabatic section. Since we know the beam parameters at the \
transition we can use adiabatic theory to propagate backwards and find the \
desired perturbative section to correct for the beam. \
\>", "Text",
 CellChangeTimes->{{3.7463771691638403`*^9, 3.746377261284114*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"I0", "=", 
  RowBox[{"-", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], "0"], 
    RowBox[{
     RowBox[{"\[Eta]p", "[", 
      RowBox[{"s", "+", "st"}], "]"}], " ", 
     RowBox[{"\[DifferentialD]", "s"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"I1", "=", 
  RowBox[{"-", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], "0"], 
    RowBox[{"s", " ", 
     RowBox[{"\[Eta]p", "[", 
      RowBox[{"s", "+", "st"}], "]"}], " ", 
     RowBox[{"\[DifferentialD]", "s"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"I2", "=", 
  RowBox[{"-", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], "0"], 
    RowBox[{
     SuperscriptBox["s", "2"], " ", 
     RowBox[{"\[Eta]p", "[", 
      RowBox[{"s", "+", "st"}], "]"}], " ", 
     RowBox[{"\[DifferentialD]", "s"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.746377364609385*^9, 3.746377427155479*^9}, {
  3.746377601380299*^9, 3.746377610446808*^9}, {3.746540305730043*^9, 
  3.746540311390758*^9}, {3.74654034531511*^9, 3.7465403477279987`*^9}, {
  3.746550578592215*^9, 3.746550623801903*^9}, {3.7465508394372063`*^9, 
  3.74655084205978*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SqrtBox[
    FractionBox["\[Pi]", "2"]]}], " ", "\[Eta]t", " ", "\[Sigma]"}]], "Output",\

 CellChangeTimes->{{3.746377428292544*^9, 3.746377435820101*^9}, 
   3.746377480328912*^9, 3.746377612650385*^9, 3.746379434706463*^9, 
   3.7463827805032997`*^9, 3.746382841086939*^9, 3.7464776097591248`*^9, 
   3.7464776700408707`*^9, 3.746477911590797*^9, 3.746478011277731*^9, 
   3.74647806018582*^9, 3.7465337687445793`*^9, {3.7465382781156063`*^9, 
   3.746538316357606*^9}, 3.746538585108762*^9, 3.746538693545933*^9, {
   3.746540183317691*^9, 3.74654020102567*^9}, 3.746540243570232*^9, {
   3.7465403131997833`*^9, 3.74654031843439*^9}, {3.746540397627941*^9, 
   3.746540473950912*^9}, 3.7465406045917463`*^9, 3.74654303112763*^9, {
   3.746543925587902*^9, 3.746543953888118*^9}, 3.7465442630008497`*^9, 
   3.7465443112720737`*^9, 3.746544643225418*^9, 3.7465456025051317`*^9, 
   3.7465456530740747`*^9, 3.7465457190440903`*^9, 3.7465462793878593`*^9, 
   3.746546395596324*^9, {3.7465469478536663`*^9, 3.746546963809807*^9}, 
   3.746547085406068*^9, 3.746547447755617*^9, 3.746547489350191*^9, {
   3.746547527063096*^9, 3.7465475671817417`*^9}, 3.746547626112422*^9, 
   3.746547688060268*^9, {3.746547750354403*^9, 3.746547773488591*^9}, {
   3.746548706550301*^9, 3.74654875562507*^9}, 3.746548791412553*^9, 
   3.746548858332223*^9, {3.746548962585005*^9, 3.74654898827528*^9}, 
   3.746549038946561*^9, 3.746549246373599*^9, 3.746549404920578*^9, 
   3.746549461019129*^9, {3.746549730636479*^9, 3.74654974421671*^9}, 
   3.746550649160769*^9, {3.7465507511963587`*^9, 3.74655077994775*^9}, 
   3.7465508512474403`*^9, 3.746552185910728*^9, {3.746552281640553*^9, 
   3.746552297985118*^9}, 3.7465555509711523`*^9, 3.746556287860321*^9, 
   3.746556496640753*^9, 3.746556600360464*^9, 3.746556801609229*^9, 
   3.746557381597701*^9, 3.746557673327737*^9, 3.746563096203805*^9, 
   3.747145003198721*^9, {3.74714704906818*^9, 3.747147067613245*^9}, 
   3.7471478990020723`*^9, 3.747148615945218*^9, 3.747148770238364*^9, 
   3.747159345149428*^9, 3.747159429839548*^9, {3.74715965414813*^9, 
   3.747159673696536*^9}, 3.747160146040642*^9}],

Cell[BoxData[
 RowBox[{"\[Eta]t", " ", 
  SuperscriptBox["\[Sigma]", "2"]}]], "Output",
 CellChangeTimes->{{3.746377428292544*^9, 3.746377435820101*^9}, 
   3.746377480328912*^9, 3.746377612650385*^9, 3.746379434706463*^9, 
   3.7463827805032997`*^9, 3.746382841086939*^9, 3.7464776097591248`*^9, 
   3.7464776700408707`*^9, 3.746477911590797*^9, 3.746478011277731*^9, 
   3.74647806018582*^9, 3.7465337687445793`*^9, {3.7465382781156063`*^9, 
   3.746538316357606*^9}, 3.746538585108762*^9, 3.746538693545933*^9, {
   3.746540183317691*^9, 3.74654020102567*^9}, 3.746540243570232*^9, {
   3.7465403131997833`*^9, 3.74654031843439*^9}, {3.746540397627941*^9, 
   3.746540473950912*^9}, 3.7465406045917463`*^9, 3.74654303112763*^9, {
   3.746543925587902*^9, 3.746543953888118*^9}, 3.7465442630008497`*^9, 
   3.7465443112720737`*^9, 3.746544643225418*^9, 3.7465456025051317`*^9, 
   3.7465456530740747`*^9, 3.7465457190440903`*^9, 3.7465462793878593`*^9, 
   3.746546395596324*^9, {3.7465469478536663`*^9, 3.746546963809807*^9}, 
   3.746547085406068*^9, 3.746547447755617*^9, 3.746547489350191*^9, {
   3.746547527063096*^9, 3.7465475671817417`*^9}, 3.746547626112422*^9, 
   3.746547688060268*^9, {3.746547750354403*^9, 3.746547773488591*^9}, {
   3.746548706550301*^9, 3.74654875562507*^9}, 3.746548791412553*^9, 
   3.746548858332223*^9, {3.746548962585005*^9, 3.74654898827528*^9}, 
   3.746549038946561*^9, 3.746549246373599*^9, 3.746549404920578*^9, 
   3.746549461019129*^9, {3.746549730636479*^9, 3.74654974421671*^9}, 
   3.746550649160769*^9, {3.7465507511963587`*^9, 3.74655077994775*^9}, 
   3.7465508512474403`*^9, 3.746552185910728*^9, {3.746552281640553*^9, 
   3.746552297985118*^9}, 3.7465555509711523`*^9, 3.746556287860321*^9, 
   3.746556496640753*^9, 3.746556600360464*^9, 3.746556801609229*^9, 
   3.746557381597701*^9, 3.746557673327737*^9, 3.746563096203805*^9, 
   3.747145003198721*^9, {3.74714704906818*^9, 3.747147067613245*^9}, 
   3.7471478990020723`*^9, 3.747148615945218*^9, 3.747148770238364*^9, 
   3.747159345149428*^9, 3.747159429839548*^9, {3.74715965414813*^9, 
   3.747159673696536*^9}, 3.7471601461652737`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SqrtBox[
    FractionBox["\[Pi]", "2"]]}], " ", "\[Eta]t", " ", 
  SuperscriptBox["\[Sigma]", "3"]}]], "Output",
 CellChangeTimes->{{3.746377428292544*^9, 3.746377435820101*^9}, 
   3.746377480328912*^9, 3.746377612650385*^9, 3.746379434706463*^9, 
   3.7463827805032997`*^9, 3.746382841086939*^9, 3.7464776097591248`*^9, 
   3.7464776700408707`*^9, 3.746477911590797*^9, 3.746478011277731*^9, 
   3.74647806018582*^9, 3.7465337687445793`*^9, {3.7465382781156063`*^9, 
   3.746538316357606*^9}, 3.746538585108762*^9, 3.746538693545933*^9, {
   3.746540183317691*^9, 3.74654020102567*^9}, 3.746540243570232*^9, {
   3.7465403131997833`*^9, 3.74654031843439*^9}, {3.746540397627941*^9, 
   3.746540473950912*^9}, 3.7465406045917463`*^9, 3.74654303112763*^9, {
   3.746543925587902*^9, 3.746543953888118*^9}, 3.7465442630008497`*^9, 
   3.7465443112720737`*^9, 3.746544643225418*^9, 3.7465456025051317`*^9, 
   3.7465456530740747`*^9, 3.7465457190440903`*^9, 3.7465462793878593`*^9, 
   3.746546395596324*^9, {3.7465469478536663`*^9, 3.746546963809807*^9}, 
   3.746547085406068*^9, 3.746547447755617*^9, 3.746547489350191*^9, {
   3.746547527063096*^9, 3.7465475671817417`*^9}, 3.746547626112422*^9, 
   3.746547688060268*^9, {3.746547750354403*^9, 3.746547773488591*^9}, {
   3.746548706550301*^9, 3.74654875562507*^9}, 3.746548791412553*^9, 
   3.746548858332223*^9, {3.746548962585005*^9, 3.74654898827528*^9}, 
   3.746549038946561*^9, 3.746549246373599*^9, 3.746549404920578*^9, 
   3.746549461019129*^9, {3.746549730636479*^9, 3.74654974421671*^9}, 
   3.746550649160769*^9, {3.7465507511963587`*^9, 3.74655077994775*^9}, 
   3.7465508512474403`*^9, 3.746552185910728*^9, {3.746552281640553*^9, 
   3.746552297985118*^9}, 3.7465555509711523`*^9, 3.746556287860321*^9, 
   3.746556496640753*^9, 3.746556600360464*^9, 3.746556801609229*^9, 
   3.746557381597701*^9, 3.746557673327737*^9, 3.746563096203805*^9, 
   3.747145003198721*^9, {3.74714704906818*^9, 3.747147067613245*^9}, 
   3.7471478990020723`*^9, 3.747148615945218*^9, 3.747148770238364*^9, 
   3.747159345149428*^9, 3.747159429839548*^9, {3.74715965414813*^9, 
   3.747159673696536*^9}, 3.747160146216824*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mb", "[", "s_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{"I0", " ", "s"}], "+", "I1"}], ",", " ", 
        RowBox[{"s", "-", 
         RowBox[{"I1", " ", "s"}], "+", "I2"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "I0"}], ",", 
        RowBox[{"1", "-", "I1"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Since", " ", "these", " ", "terms", " ", 
    RowBox[{"don", "'"}], "t", " ", "depend", " ", "on", " ", "s"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Gamma]", "=", 
  RowBox[{
   RowBox[{"\[Beta]t", " ", 
    SuperscriptBox[
     RowBox[{
      RowBox[{"Mb", "[", "0", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "2"]}], "-", 
   RowBox[{"\[Alpha]m", " ", "2", " ", 
    RowBox[{
     RowBox[{"Mb", "[", "0", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
    RowBox[{
     RowBox[{"Mb", "[", "0", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
   RowBox[{"\[Gamma]t", " ", 
    SuperscriptBox[
     RowBox[{
      RowBox[{"Mb", "[", "0", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], 
     "2"]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]t", ":=", 
   FractionBox["1", 
    SqrtBox["\[Eta]t"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]t", ":=", 
   FractionBox[
    RowBox[{"1", "+", 
     SuperscriptBox["\[Alpha]m", "2"]}], "\[Beta]t"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.746378413363811*^9, 3.7463786244549627`*^9}, {
  3.746378801934815*^9, 3.746378829910624*^9}, {3.746379017757639*^9, 
  3.746379100501131*^9}, {3.746379717860229*^9, 3.7463797342084846`*^9}, {
  3.746543024931664*^9, 3.7465430252895327`*^9}, {3.7465439656249647`*^9, 
  3.746544014756907*^9}, {3.7465441420181427`*^9, 3.7465441567847443`*^9}, {
  3.746545332180682*^9, 3.746545371472097*^9}, {3.746545696555469*^9, 
  3.7465456974896793`*^9}, {3.7465457660250597`*^9, 3.74654576637451*^9}, {
  3.746546344110696*^9, 3.746546390481577*^9}, {3.746546423824562*^9, 
  3.7465464251897297`*^9}, {3.7465469346965523`*^9, 3.7465469355443068`*^9}, {
  3.746547383283572*^9, 3.746547383673768*^9}, {3.746547422036068*^9, 
  3.7465474399161654`*^9}, {3.746550654390674*^9, 3.7465506591653423`*^9}, {
  3.74655072001379*^9, 3.746550746251996*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[Pi]", " ", "\[Beta]t", " ", 
   SuperscriptBox["\[Eta]t", "2"], " ", 
   SuperscriptBox["\[Sigma]", "2"]}], "-", 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", "\[Alpha]m", " ", "\[Eta]t", " ", 
   "\[Sigma]", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"\[Eta]t", " ", 
      SuperscriptBox["\[Sigma]", "2"]}]}], ")"}]}], "+", 
  RowBox[{"\[Gamma]t", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"\[Eta]t", " ", 
       SuperscriptBox["\[Sigma]", "2"]}]}], ")"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.7463790797508698`*^9, 3.746379101306107*^9}, 
   3.746379437971615*^9, {3.7463797277364902`*^9, 3.746379735142627*^9}, 
   3.746382780689918*^9, 3.746382841276565*^9, 3.746477609958768*^9, 
   3.7464776702307873`*^9, {3.746477896990561*^9, 3.746477911778406*^9}, 
   3.746478011467791*^9, 3.7464780603867407`*^9, 3.746533768948432*^9, {
   3.7465382783377132`*^9, 3.7465383166533623`*^9}, 3.746538585304779*^9, 
   3.74653869375069*^9, {3.746540183523525*^9, 3.7465402019896*^9}, 
   3.7465402437713346`*^9, 3.7465403186341543`*^9, {3.746540395176024*^9, 
   3.746540474154977*^9}, 3.746540607738109*^9, {3.746543026212957*^9, 
   3.746543031430441*^9}, 3.746543925776009*^9, 3.746543956336173*^9, {
   3.746544145266446*^9, 3.746544157646575*^9}, 3.746544263543912*^9, 
   3.74654431158066*^9, 3.746544646173395*^9, 3.746545260353647*^9, 
   3.7465453819172277`*^9, 3.7465456027975197`*^9, 3.746545653326758*^9, {
   3.7465457478245564`*^9, 3.746545767466784*^9}, 3.746546282528061*^9, {
   3.746546367902665*^9, 3.746546395748124*^9}, {3.746546948093461*^9, 
   3.746546964090201*^9}, 3.7465470902612743`*^9, 3.746547395162418*^9, 
   3.7465474480267267`*^9, 3.746547489657278*^9, {3.7465475273776817`*^9, 
   3.7465475673783607`*^9}, 3.746547626306425*^9, 3.746547688256472*^9, {
   3.746547750549933*^9, 3.746547773683927*^9}, {3.746548706746663*^9, 
   3.746548755876049*^9}, 3.746548791664021*^9, 3.746548858613361*^9, {
   3.746548962786841*^9, 3.746548988470326*^9}, 3.7465490391471443`*^9, 
   3.746549246567378*^9, 3.746549405161828*^9, 3.746549463367239*^9, {
   3.746549730878154*^9, 3.7465497471614017`*^9}, 3.746550678825326*^9, 
   3.746550721357428*^9, 3.7465507515473747`*^9, 3.746550784951783*^9, 
   3.7465508547046022`*^9, 3.746552186469283*^9, {3.7465522821541157`*^9, 
   3.746552298399682*^9}, 3.746555551312718*^9, 3.7465562881903353`*^9, 
   3.746556496874007*^9, 3.746556600592601*^9, 3.7465568018183393`*^9, 
   3.746557381902363*^9, 3.746557673528904*^9, 3.746563096509816*^9, 
   3.7471450034935007`*^9, {3.7471470492770977`*^9, 3.747147067787559*^9}, 
   3.747147899247613*^9, 3.747148616171035*^9, 3.747148770463737*^9, 
   3.747159345312978*^9, 3.747159430028343*^9, {3.747159654358036*^9, 
   3.7471596738844147`*^9}, 3.7471601462371807`*^9}]
}, Open  ]],

Cell["\<\
At this point we have the free space gamma at large s in terms of sigma so we \
can solve for sigma. The expression is\
\>", "Text",
 CellChangeTimes->{{3.746379069124248*^9, 3.746379073099895*^9}, {
  3.7463791229322166`*^9, 3.746379158635996*^9}, {3.746379228987853*^9, 
  3.746379232603854*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]m", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]t", "=", "0.012"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]s", "=", "10."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"\[Gamma]", "\[Equal]", 
     FractionBox["1", "\[Beta]s"]}], ",", "\[Sigma]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.746379372994047*^9, 3.746379416989524*^9}, {
   3.7463794499979353`*^9, 3.746379485046423*^9}, {3.7463810931037893`*^9, 
   3.746381097070982*^9}, {3.7465470965068607`*^9, 3.7465471902887287`*^9}, {
   3.746547267933445*^9, 3.746547317997861*^9}, {3.746547388747942*^9, 
   3.746547390120948*^9}, 3.7465474875365477`*^9, {3.746548703516089*^9, 
   3.746548704002809*^9}, 3.7465487396358347`*^9, {3.746548788924624*^9, 
   3.746548789043015*^9}, {3.7465488428541193`*^9, 3.746548843395961*^9}, {
   3.746548958885701*^9, 3.746548986405119*^9}, {3.747147894652137*^9, 
   3.7471478948147707`*^9}, {3.7471487578714323`*^9, 3.747148758031645*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Sigma]", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "5.4697441316318915`"}], "-", 
      RowBox[{"3.4583497310274125`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "5.4697441316318915`"}], "+", 
      RowBox[{"3.4583497310274125`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]", "\[Rule]", "2.64512577612646`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]", "\[Rule]", "6.028790128563638`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.746379487184628*^9, {3.746379730541499*^9, 3.7463797370771017`*^9}, 
   3.74638111012186*^9, 3.746382780703463*^9, 3.7463828412973347`*^9, 
   3.746477609977859*^9, 3.746477670245434*^9, 3.746477911792347*^9, 
   3.746478011487268*^9, 3.7464780604122257`*^9, 3.746533768967792*^9, {
   3.7465382784329853`*^9, 3.7465383170992727`*^9}, 3.74653858532095*^9, 
   3.7465386937718563`*^9, {3.746540183550446*^9, 3.746540202035071*^9}, 
   3.746540243791315*^9, 3.746540318653405*^9, {3.74654039785844*^9, 
   3.746540474179681*^9}, 3.74654061176663*^9, 3.746543031876526*^9, 
   3.746543925948264*^9, 3.746543960424981*^9, {3.74654415106555*^9, 
   3.746544159604146*^9}, 3.746544264243541*^9, 3.746544311815858*^9, 
   3.746544649502438*^9, 3.746545602851755*^9, 3.746545653428866*^9, {
   3.746545754272952*^9, 3.7465457717131367`*^9}, 3.746546395849411*^9, {
   3.746546948128911*^9, 3.7465469641302643`*^9}, {3.746547093557518*^9, 
   3.746547191027676*^9}, {3.74654726874055*^9, 3.7465473186868963`*^9}, {
   3.746547391239596*^9, 3.746547396707445*^9}, 3.746547448032297*^9, 
   3.7465474897308702`*^9, {3.7465475274848967`*^9, 3.746547567404243*^9}, 
   3.746547626333637*^9, 3.7465476882837057`*^9, {3.746547750573696*^9, 
   3.746547773710253*^9}, {3.74654870676849*^9, 3.746548755947543*^9}, 
   3.746548791716851*^9, 3.746548858685796*^9, {3.7465489628119993`*^9, 
   3.746548988493639*^9}, 3.7465490391734858`*^9, 3.746549246591324*^9, 
   3.7465494052250557`*^9, 3.746549465705084*^9, {3.746549730926202*^9, 
   3.746549750101205*^9}, 3.746550684745452*^9, {3.746550724982835*^9, 
   3.746550751846128*^9}, 3.7465507895023813`*^9, 3.7465508574686604`*^9, 
   3.746552186718454*^9, {3.746552282595495*^9, 3.746552298751195*^9}, 
   3.746555551418565*^9, 3.7465562882812757`*^9, 3.746556496929782*^9, 
   3.746556600660718*^9, 3.746556801844082*^9, 3.746557381993187*^9, 
   3.74655767354937*^9, 3.746563096595837*^9, 3.747145003593883*^9, {
   3.7471470494203987`*^9, 3.747147067907267*^9}, 3.747147899382022*^9, 
   3.747148616287447*^9, 3.7471487705986013`*^9, 3.747159345338849*^9, 
   3.7471594300441113`*^9, {3.747159654373105*^9, 3.7471596739002132`*^9}, 
   3.747160146255619*^9}]
}, Open  ]],

Cell["Lets compare to the asymptotic solution", "Text",
 CellChangeTimes->{{3.746382695117729*^9, 3.74638270867505*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"\[Beta]s", "\[Equal]", 
    FractionBox["1", 
     RowBox[{"\[Gamma]t", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Alpha]m", " ", "I0"}], "-", 
         RowBox[{"\[Gamma]t", " ", "I1"}]}], ")"}]}]}]]}], ",", "\[Sigma]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.746382714102347*^9, 3.746382759543108*^9}, {
   3.746382806346986*^9, 3.746382808209641*^9}, 3.746477656275317*^9, {
   3.746547549657477*^9, 3.746547563793818*^9}, 3.746547623339892*^9, 
   3.746547683781385*^9, {3.746547856452951*^9, 3.746547874134316*^9}, 
   3.7465487210699263`*^9, {3.746548751484054*^9, 3.7465487656363697`*^9}, {
   3.746548813187351*^9, 3.746548813635805*^9}, 3.74655076372581*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Sigma]", "\[Rule]", 
     RowBox[{"-", "2.646723832819264`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]", "\[Rule]", "1.5139376535324214`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.746382763480719*^9, 3.746382780726721*^9}, 
   3.746382841327145*^9, 3.746477610014429*^9, {3.7464776656225243`*^9, 
   3.7464776702655277`*^9}, 3.746477911812886*^9, 3.7464780115118227`*^9, 
   3.746478060443714*^9, 3.746533768992625*^9, {3.746538278565859*^9, 
   3.746538317855446*^9}, 3.74653858534466*^9, 3.746538693798562*^9, {
   3.7465401835824738`*^9, 3.746540202088912*^9}, 3.7465402438034687`*^9, 
   3.746540318678214*^9, {3.7465403978858423`*^9, 3.7465404742114143`*^9}, 
   3.746540616247332*^9, 3.746543032117874*^9, 3.746543926120502*^9, 
   3.7465442645723457`*^9, 3.746544312173357*^9, 3.7465446525512037`*^9, 
   3.746545602964239*^9, 3.74654565349533*^9, 3.746546395949256*^9, {
   3.746546948194414*^9, 3.746546964175304*^9}, 3.746547404934196*^9, 
   3.746547448164463*^9, 3.746547489825459*^9, {3.746547527605064*^9, 
   3.746547567434863*^9}, 3.7465476263680267`*^9, {3.746547685063116*^9, 
   3.746547688314762*^9}, {3.746547750615539*^9, 3.746547773743973*^9}, {
   3.746548706796311*^9, 3.746548756021962*^9}, 3.746548791770611*^9, 
   3.746548858761757*^9, {3.746548962834692*^9, 3.746548988514099*^9}, 
   3.746549039198543*^9, 3.7465492466149673`*^9, 3.746549405288148*^9, 
   3.7465494683819227`*^9, {3.746549730975369*^9, 3.746549753035461*^9}, 
   3.746550752274684*^9, 3.746550792742975*^9, 3.746550864972333*^9, 
   3.746552186970805*^9, {3.746552282905466*^9, 3.7465522991541367`*^9}, 
   3.7465555515298443`*^9, 3.746556288381138*^9, 3.746556496994935*^9, 
   3.7465566007360373`*^9, 3.746556801874909*^9, 3.746557382090302*^9, 
   3.7465576735754747`*^9, 3.74656309668967*^9, 3.747145003729804*^9, {
   3.747147049545431*^9, 3.7471470680516367`*^9}, 3.747147899523121*^9, 
   3.747148616417804*^9, 3.747148770737688*^9, 3.747159345373509*^9, 
   3.74715943006024*^9, {3.747159654387982*^9, 3.747159673916141*^9}, 
   3.747160146274335*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[Sigma]", "=", 
    RowBox[{"\[Sigma]", "/.", 
     RowBox[{"%", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"\[Sigma]", "/.", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.746382831670732*^9, 3.746382836582839*^9}, 
   3.7465383134465523`*^9, 3.746540179537592*^9, {3.746540405978496*^9, 
   3.746540441298882*^9}, {3.746545582505075*^9, 3.74654558508704*^9}, {
   3.746547474836808*^9, 3.746547478252429*^9}, {3.7465487798840733`*^9, 
   3.746548782571168*^9}, {3.746548852227758*^9, 3.7465488526753883`*^9}}],

Cell[BoxData["2.64512577612646`"], "Output",
 CellChangeTimes->{
  3.746548858833877*^9, {3.746548962840075*^9, 3.746548988519528*^9}, 
   3.746549039226165*^9, 3.746549246638361*^9, 3.7465494052937107`*^9, 
   3.746549470456875*^9, {3.7465497310243063`*^9, 3.7465497550553913`*^9}, 
   3.746550752441387*^9, 3.7465508699717817`*^9, 3.7465521873279037`*^9, {
   3.746552283113603*^9, 3.746552299541256*^9}, 3.746555551737721*^9, 
   3.746556288386876*^9, 3.746556497000784*^9, 3.7465566007419243`*^9, 
   3.746556801880734*^9, 3.746557382193511*^9, 3.746557673581616*^9, 
   3.746563096695868*^9, 3.747145004055422*^9, {3.7471470496825027`*^9, 
   3.747147068171233*^9}, 3.7471478996286488`*^9, 3.747148616486432*^9, 
   3.747148770875793*^9, 3.747159345376548*^9, 3.747159430063355*^9, {
   3.74715965439139*^9, 3.747159673931493*^9}, 3.747160146277567*^9}]
}, Open  ]],

Cell["Now we need to back propagate one of the other CS parameters", "Text",
 CellChangeTimes->{{3.746379776371442*^9, 3.746379790918447*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", "s_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Beta]t", " ", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"Mb", "[", "s", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "2"]}], "-", 
    RowBox[{"\[Alpha]m", " ", "2", " ", 
     RowBox[{
      RowBox[{"Mb", "[", "s", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
     RowBox[{
      RowBox[{"Mb", "[", "s", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
    RowBox[{"\[Gamma]t", " ", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"Mb", "[", "s", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "2"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zm", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"co", "=", 
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"\[Beta]", "[", "s", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", "6"}], "}"}]}], "]"}], ",", "s"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ss", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"co", "[", 
      RowBox[{"[", "2", "]"}], "]"}], 
     RowBox[{"2", " ", 
      RowBox[{"co", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]]}], "+", "st"}]}]}], "Input",
 CellChangeTimes->{{3.7463803615947933`*^9, 3.746380385151423*^9}, {
   3.746380957782774*^9, 3.746381006799007*^9}, {3.746381038727511*^9, 
   3.746381061718795*^9}, {3.7463811319441643`*^9, 3.746381186470276*^9}, {
   3.746381224637969*^9, 3.746381352461384*^9}, {3.7463814055899963`*^9, 
   3.7463814234935513`*^9}, {3.7463814614954023`*^9, 
   3.7463814635971327`*^9}, {3.746381565164833*^9, 3.746381591756261*^9}, {
   3.7463816227893057`*^9, 3.74638162851667*^9}, {3.74638172432448*^9, 
   3.746381828427009*^9}, {3.746382053260908*^9, 3.7463821894653673`*^9}, {
   3.746382221595574*^9, 3.746382257412005*^9}, {3.7463824365712013`*^9, 
   3.7463824392091827`*^9}, {3.746474597428357*^9, 3.746474608001192*^9}, {
   3.746474738826602*^9, 3.7464747948799*^9}, {3.7464748458350067`*^9, 
   3.746474846543106*^9}, {3.746533739004281*^9, 3.746533761495779*^9}, {
   3.746540462372794*^9, 3.746540471212981*^9}, {3.746540556363413*^9, 
   3.746540572468038*^9}, {3.746540777319331*^9, 3.7465408648095093`*^9}, {
   3.7465412844223347`*^9, 3.746541308235662*^9}, {3.7465439181340733`*^9, 
   3.746543945727461*^9}, {3.7465442382598257`*^9, 3.746544247731414*^9}, {
   3.746544302896493*^9, 3.746544303413659*^9}, {3.746544629369815*^9, 
   3.746544631935873*^9}, {3.746544662581196*^9, 3.7465446696736517`*^9}, {
   3.746544786212726*^9, 3.746544800493572*^9}, {3.746544890576005*^9, 
   3.746544933408165*^9}, {3.746544988479618*^9, 3.746545013616006*^9}, 
   3.74654504666765*^9, {3.7465458479789886`*^9, 3.746545877187991*^9}, {
   3.746545919867269*^9, 3.74654592424489*^9}, {3.746547409495399*^9, 
   3.746547409690577*^9}, {3.746547516642241*^9, 3.746547517342641*^9}, {
   3.746547744056301*^9, 3.746547744525434*^9}, {3.746550880180217*^9, 
   3.746550900690216*^9}, {3.747159224828794*^9, 3.747159226051929*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10.79487296650195`", ",", "0.5345040453325612`", ",", 
   "0.09999999999999999`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.746381062433214*^9, {3.746381121040744*^9, 3.746381145977171*^9}, 
   3.74638127922792*^9, {3.746381317780442*^9, 3.746381359169037*^9}, {
   3.7463814086250153`*^9, 3.746381424825078*^9}, 3.7463814644532137`*^9, {
   3.74638157988391*^9, 3.746381594023499*^9}, 3.746381629256549*^9, {
   3.746381728486477*^9, 3.746381786055748*^9}, {3.7463818173048162`*^9, 
   3.746381829100665*^9}, {3.746382054768066*^9, 3.746382190212696*^9}, {
   3.746382222491312*^9, 3.746382258723707*^9}, 3.746382460397732*^9, 
   3.746382780754511*^9, 3.746382841377018*^9, {3.7464746008973417`*^9, 
   3.7464746098691607`*^9}, {3.746474739962899*^9, 3.746474795520238*^9}, 
   3.746474847251975*^9, 3.746477610071086*^9, 3.7464776703028584`*^9, 
   3.746477911851674*^9, 3.746478011581214*^9, 3.746478060499674*^9, {
   3.7465337627812157`*^9, 3.746533769021106*^9}, {3.746538278985853*^9, 
   3.746538318226769*^9}, 3.746538585381712*^9, 3.7465386938292637`*^9, {
   3.746540183634881*^9, 3.746540202139413*^9}, 3.746540243847499*^9, 
   3.7465403187052307`*^9, {3.7465403979147997`*^9, 3.746540474259664*^9}, {
   3.746540562181769*^9, 3.746540568539406*^9}, 3.746540621101156*^9, {
   3.7465407807861347`*^9, 3.746540865701458*^9}, {3.7465412855057983`*^9, 
   3.746541309276046*^9}, 3.746543032753737*^9, {3.7465439210657454`*^9, 
   3.7465439266466303`*^9}, {3.746544248842012*^9, 3.746544265395071*^9}, {
   3.7465443043773327`*^9, 3.7465443125922947`*^9}, {3.7465446585090733`*^9, 
   3.7465446709055223`*^9}, 3.746544801364645*^9, 3.746544935579743*^9, {
   3.746544989362362*^9, 3.746545014435915*^9}, 3.746545047379133*^9, 
   3.7465452731942883`*^9, 3.746545603022937*^9, 3.7465456535452423`*^9, 
   3.746545786990996*^9, {3.746545911858577*^9, 3.74654592574933*^9}, 
   3.746546395996586*^9, {3.7465469482111053`*^9, 3.746546964237507*^9}, 
   3.746547410590044*^9, 3.7465474482717657`*^9, 3.746547489932144*^9, {
   3.746547521621398*^9, 3.746547567471386*^9}, 3.746547626405959*^9, 
   3.746547688369152*^9, {3.746547746317824*^9, 3.746547773779187*^9}, {
   3.7465487068286533`*^9, 3.746548756088489*^9}, 3.746548791845516*^9, 
   3.746548858900773*^9, {3.7465489628664093`*^9, 3.7465489885429993`*^9}, 
   3.746549039255239*^9, 3.746549246663599*^9, 3.746549405366096*^9, 
   3.74654947332043*^9, {3.746549731069529*^9, 3.746549757990858*^9}, 
   3.7465507526662292`*^9, {3.746550873414481*^9, 3.7465509048696203`*^9}, 
   3.746552187806569*^9, {3.746552283390155*^9, 3.746552299904688*^9}, 
   3.74655555178753*^9, 3.746556288471367*^9, 3.7465564970262127`*^9, 
   3.746556600818543*^9, 3.746556801906557*^9, 3.746557382366754*^9, 
   3.746557673607697*^9, 3.7465630967896643`*^9, 3.747145004211779*^9, {
   3.747147049915189*^9, 3.74714706830239*^9}, 3.747147899917069*^9, 
   3.747148616623582*^9, 3.747148771159083*^9, 3.747159345394113*^9, 
   3.747159430082762*^9, {3.7471596544085083`*^9, 3.747159673946753*^9}, 
   3.747160146298876*^9}],

Cell[BoxData[
 RowBox[{"-", "48.04137885605013`"}]], "Output",
 CellChangeTimes->{
  3.746381062433214*^9, {3.746381121040744*^9, 3.746381145977171*^9}, 
   3.74638127922792*^9, {3.746381317780442*^9, 3.746381359169037*^9}, {
   3.7463814086250153`*^9, 3.746381424825078*^9}, 3.7463814644532137`*^9, {
   3.74638157988391*^9, 3.746381594023499*^9}, 3.746381629256549*^9, {
   3.746381728486477*^9, 3.746381786055748*^9}, {3.7463818173048162`*^9, 
   3.746381829100665*^9}, {3.746382054768066*^9, 3.746382190212696*^9}, {
   3.746382222491312*^9, 3.746382258723707*^9}, 3.746382460397732*^9, 
   3.746382780754511*^9, 3.746382841377018*^9, {3.7464746008973417`*^9, 
   3.7464746098691607`*^9}, {3.746474739962899*^9, 3.746474795520238*^9}, 
   3.746474847251975*^9, 3.746477610071086*^9, 3.7464776703028584`*^9, 
   3.746477911851674*^9, 3.746478011581214*^9, 3.746478060499674*^9, {
   3.7465337627812157`*^9, 3.746533769021106*^9}, {3.746538278985853*^9, 
   3.746538318226769*^9}, 3.746538585381712*^9, 3.7465386938292637`*^9, {
   3.746540183634881*^9, 3.746540202139413*^9}, 3.746540243847499*^9, 
   3.7465403187052307`*^9, {3.7465403979147997`*^9, 3.746540474259664*^9}, {
   3.746540562181769*^9, 3.746540568539406*^9}, 3.746540621101156*^9, {
   3.7465407807861347`*^9, 3.746540865701458*^9}, {3.7465412855057983`*^9, 
   3.746541309276046*^9}, 3.746543032753737*^9, {3.7465439210657454`*^9, 
   3.7465439266466303`*^9}, {3.746544248842012*^9, 3.746544265395071*^9}, {
   3.7465443043773327`*^9, 3.7465443125922947`*^9}, {3.7465446585090733`*^9, 
   3.7465446709055223`*^9}, 3.746544801364645*^9, 3.746544935579743*^9, {
   3.746544989362362*^9, 3.746545014435915*^9}, 3.746545047379133*^9, 
   3.7465452731942883`*^9, 3.746545603022937*^9, 3.7465456535452423`*^9, 
   3.746545786990996*^9, {3.746545911858577*^9, 3.74654592574933*^9}, 
   3.746546395996586*^9, {3.7465469482111053`*^9, 3.746546964237507*^9}, 
   3.746547410590044*^9, 3.7465474482717657`*^9, 3.746547489932144*^9, {
   3.746547521621398*^9, 3.746547567471386*^9}, 3.746547626405959*^9, 
   3.746547688369152*^9, {3.746547746317824*^9, 3.746547773779187*^9}, {
   3.7465487068286533`*^9, 3.746548756088489*^9}, 3.746548791845516*^9, 
   3.746548858900773*^9, {3.7465489628664093`*^9, 3.7465489885429993`*^9}, 
   3.746549039255239*^9, 3.746549246663599*^9, 3.746549405366096*^9, 
   3.74654947332043*^9, {3.746549731069529*^9, 3.746549757990858*^9}, 
   3.7465507526662292`*^9, {3.746550873414481*^9, 3.7465509048696203`*^9}, 
   3.746552187806569*^9, {3.746552283390155*^9, 3.746552299904688*^9}, 
   3.74655555178753*^9, 3.746556288471367*^9, 3.7465564970262127`*^9, 
   3.746556600818543*^9, 3.746556801906557*^9, 3.746557382366754*^9, 
   3.746557673607697*^9, 3.7465630967896643`*^9, 3.747145004211779*^9, {
   3.747147049915189*^9, 3.74714706830239*^9}, 3.747147899917069*^9, 
   3.747148616623582*^9, 3.747148771159083*^9, 3.747159345394113*^9, 
   3.747159430082762*^9, {3.7471596544085083`*^9, 3.747159673946753*^9}, 
   3.7471601462998734`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"\[Gamma]t", "+", 
   RowBox[{"2", " ", 
    RowBox[{"(", "\[AlignmentMarker]", 
     RowBox[{
      RowBox[{"\[Alpha]m", " ", "I0"}], "-", 
      RowBox[{"\[Gamma]t", " ", "I1"}]}], ")"}]}]}]]], "Input",
 CellChangeTimes->{{3.7463824626839933`*^9, 3.746382494495974*^9}, {
   3.74654776265552*^9, 3.746547770935561*^9}, 3.746549234474533*^9, 
   3.7465509140429153`*^9}],

Cell[BoxData["11.88992558714989`"], "Output",
 CellChangeTimes->{
  3.7463824954373627`*^9, 3.746382780773889*^9, 3.7463828413986263`*^9, {
   3.74647758858525*^9, 3.746477610092416*^9}, 3.74647767032303*^9, 
   3.746477911871277*^9, 3.7464780116073933`*^9, 3.746478060525466*^9, 
   3.7465337690260468`*^9, {3.746538279129849*^9, 3.7465383187064123`*^9}, 
   3.746538585402515*^9, 3.746538693834806*^9, {3.746540183640435*^9, 
   3.746540202145514*^9}, 3.7465402438530817`*^9, 3.746540318711133*^9, {
   3.74654039792065*^9, 3.746540474285906*^9}, 3.746543033475626*^9, 
   3.746543926841922*^9, 3.746544265623395*^9, 3.74654431287658*^9, 
   3.74654560308311*^9, 3.746545653567178*^9, 3.746546396005959*^9, {
   3.7465469482711267`*^9, 3.7465469642468147`*^9}, 3.7465474482824583`*^9, 
   3.7465474899426003`*^9, {3.746547527961471*^9, 3.7465475674796247`*^9}, 
   3.746547626413772*^9, 3.746547688377792*^9, {3.7465477506615267`*^9, 
   3.746547773786995*^9}, {3.746548706835178*^9, 3.7465487560949707`*^9}, 
   3.7465487918523703`*^9, 3.746548858908407*^9, {3.7465489628734913`*^9, 
   3.7465489885498743`*^9}, 3.746549039262313*^9, {3.7465492434585657`*^9, 
   3.74654924668921*^9}, 3.746549405373254*^9, 3.746549479442347*^9, {
   3.7465497311208487`*^9, 3.746549760782256*^9}, 3.7465507529417143`*^9, {
   3.746550911832616*^9, 3.746550915254253*^9}, 3.746552188097315*^9, {
   3.746552283994506*^9, 3.746552300202509*^9}, 3.7465555517957582`*^9, 
   3.7465562884790897`*^9, 3.746556497034032*^9, 3.7465566008264427`*^9, 
   3.7465568019145107`*^9, 3.74655738286097*^9, 3.74655767361614*^9, 
   3.746563096797858*^9, 3.7471450043013268`*^9, {3.747147049996291*^9, 
   3.747147068553505*^9}, 3.747147900068879*^9, 3.747148616690901*^9, 
   3.747148771307601*^9, 3.747159345420475*^9, 3.747159430086463*^9, {
   3.74715965441234*^9, 3.747159673963756*^9}, 3.747160146303348*^9}]
}, Open  ]],

Cell["\<\
For off energy components the transport matrix is a function of \[Delta].\
\>", "Text",
 CellChangeTimes->{{3.746477557377192*^9, 3.746477557905176*^9}, {
  3.74647768968043*^9, 3.7464777073366823`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"I0", "=", 
   FractionBox["I0", 
    RowBox[{"1", "+", "\[Delta]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1", "=", 
   FractionBox["I1", 
    RowBox[{"1", "+", "\[Delta]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I2", "=", 
   FractionBox["I2", 
    RowBox[{"1", "+", "\[Delta]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"-", "zm"}], "-", "st"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mp", "[", "\[Delta]_", "]"}], "=", 
  RowBox[{"Inverse", "[", 
   RowBox[{"Mb", "[", 
    RowBox[{
     RowBox[{"-", "zm"}], "-", "st"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7464778123209352`*^9, 3.74647786326972*^9}, {
  3.746477918935829*^9, 3.746478055057969*^9}, {3.746538650803032*^9, 
  3.746538652186734*^9}, {3.746538684525805*^9, 3.746538688467132*^9}, {
  3.746549449554976*^9, 3.7465494518509417`*^9}, {3.746550933619529*^9, 
  3.74655094619792*^9}}],

Cell[BoxData[
 RowBox[{"-", "54.631141370612674`"}]], "Output",
 CellChangeTimes->{
  3.7464778192747*^9, {3.746477858773623*^9, 3.746477863989519*^9}, {
   3.746477902721249*^9, 3.7464779118855762`*^9}, {3.746478006931365*^9, 
   3.746478011635446*^9}, {3.7464780525791693`*^9, 3.746478060553822*^9}, 
   3.746533769042653*^9, {3.746538279229794*^9, 3.746538318918281*^9}, 
   3.746538585433268*^9, 3.74653865310511*^9, 3.746538693857939*^9, {
   3.7465401836614428`*^9, 3.746540202161457*^9}, 3.746540243872991*^9, 
   3.7465403187309113`*^9, {3.746540397944872*^9, 3.74654047431179*^9}, 
   3.746543033651016*^9, 3.746543927019166*^9, 3.746544266058723*^9, 
   3.746544313315947*^9, 3.746545603174799*^9, 3.746545653596675*^9, 
   3.7465463960788727`*^9, {3.746546948327303*^9, 3.7465469642881737`*^9}, 
   3.7465474483464403`*^9, 3.746547490022847*^9, {3.746547528053975*^9, 
   3.7465475675021563`*^9}, 3.746547626435968*^9, 3.7465476883997*^9, {
   3.746547750685073*^9, 3.746547773809863*^9}, {3.746548706855948*^9, 
   3.746548756154394*^9}, 3.746548791928411*^9, 3.746548858951044*^9, {
   3.7465489628971643`*^9, 3.746548988573278*^9}, 3.746549039287656*^9, 
   3.746549246714951*^9, 3.7465494054417763`*^9, 3.74654948183442*^9, 
   3.746549731264027*^9, 3.7465497756793957`*^9, 3.746550753543771*^9, {
   3.7465509416557083`*^9, 3.746550947093259*^9}, 3.746552188319762*^9, {
   3.7465522844861183`*^9, 3.746552300407036*^9}, 3.7465555518444853`*^9, 
   3.746556288606552*^9, 3.746556497072135*^9, 3.746556600888433*^9, 
   3.746556801940827*^9, 3.746557383080411*^9, 3.746557673639407*^9, 
   3.746563096891728*^9, 3.7471450044408712`*^9, {3.747147050075292*^9, 
   3.747147068743445*^9}, 3.747147900141447*^9, 3.747148616756659*^9, 
   3.747148771466831*^9, 3.747159345439312*^9, 3.747159430104265*^9, {
   3.747159654426745*^9, 3.747159673979726*^9}, 3.747160146322488*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", 
       FractionBox["0.0839602844583433`", 
        RowBox[{"1", "+", "\[Delta]"}]]}], 
      RowBox[{"1.`", "\[VeryThinSpace]", "+", 
       FractionBox["0.004023731308666262`", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Delta]"}], ")"}], "2"]]}]], ",", 
     FractionBox[
      RowBox[{"54.631141370612674`", "\[VeryThinSpace]", "-", 
       FractionBox["4.308503257136502`", 
        RowBox[{"1", "+", "\[Delta]"}]]}], 
      RowBox[{"1.`", "\[VeryThinSpace]", "+", 
       FractionBox["0.004023731308666262`", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Delta]"}], ")"}], "2"]]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["0.03978208236236313`", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Delta]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1.`", "\[VeryThinSpace]", "+", 
          FractionBox["0.004023731308666262`", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Delta]"}], ")"}], "2"]]}], ")"}]}]]}], ",", 
     
     FractionBox[
      RowBox[{"1", "-", 
       FractionBox["2.0893802810972737`", 
        RowBox[{"1", "+", "\[Delta]"}]]}], 
      RowBox[{"1.`", "\[VeryThinSpace]", "+", 
       FractionBox["0.004023731308666262`", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Delta]"}], ")"}], "2"]]}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7464778192747*^9, {3.746477858773623*^9, 3.746477863989519*^9}, {
   3.746477902721249*^9, 3.7464779118855762`*^9}, {3.746478006931365*^9, 
   3.746478011635446*^9}, {3.7464780525791693`*^9, 3.746478060553822*^9}, 
   3.746533769042653*^9, {3.746538279229794*^9, 3.746538318918281*^9}, 
   3.746538585433268*^9, 3.74653865310511*^9, 3.746538693857939*^9, {
   3.7465401836614428`*^9, 3.746540202161457*^9}, 3.746540243872991*^9, 
   3.7465403187309113`*^9, {3.746540397944872*^9, 3.74654047431179*^9}, 
   3.746543033651016*^9, 3.746543927019166*^9, 3.746544266058723*^9, 
   3.746544313315947*^9, 3.746545603174799*^9, 3.746545653596675*^9, 
   3.7465463960788727`*^9, {3.746546948327303*^9, 3.7465469642881737`*^9}, 
   3.7465474483464403`*^9, 3.746547490022847*^9, {3.746547528053975*^9, 
   3.7465475675021563`*^9}, 3.746547626435968*^9, 3.7465476883997*^9, {
   3.746547750685073*^9, 3.746547773809863*^9}, {3.746548706855948*^9, 
   3.746548756154394*^9}, 3.746548791928411*^9, 3.746548858951044*^9, {
   3.7465489628971643`*^9, 3.746548988573278*^9}, 3.746549039287656*^9, 
   3.746549246714951*^9, 3.7465494054417763`*^9, 3.74654948183442*^9, 
   3.746549731264027*^9, 3.7465497756793957`*^9, 3.746550753543771*^9, {
   3.7465509416557083`*^9, 3.746550947093259*^9}, 3.746552188319762*^9, {
   3.7465522844861183`*^9, 3.746552300407036*^9}, 3.7465555518444853`*^9, 
   3.746556288606552*^9, 3.746556497072135*^9, 3.746556600888433*^9, 
   3.746556801940827*^9, 3.746557383080411*^9, 3.746557673639407*^9, 
   3.746563096891728*^9, 3.7471450044408712`*^9, {3.747147050075292*^9, 
   3.747147068743445*^9}, 3.747147900141447*^9, 3.747148616756659*^9, 
   3.747148771466831*^9, 3.747159345439312*^9, 3.747159430104265*^9, {
   3.747159654426745*^9, 3.747159673979726*^9}, 3.747160146323639*^9}]
}, Open  ]],

Cell["\<\
Now we can propagate the incoming beam forward to see what it looks like.\
\>", "Text",
 CellChangeTimes->{{3.746478073511402*^9, 3.7464780860637608`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Alpha]0", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", "\[Delta]_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]0", "[", "\[Delta]", "]"}], " ", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"\[Alpha]0", "[", "\[Delta]", "]"}], " ", "2", " ", 
     RowBox[{
      RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
     RowBox[{
      RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"\[Gamma]0", "[", "\[Delta]", "]"}], " ", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "2"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "[", "\[Delta]_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"\[Beta]0", "[", "\[Delta]", "]"}]}], 
    RowBox[{
     RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
    RowBox[{
     RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"\[Alpha]0", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"\[Gamma]0", "[", "\[Delta]", "]"}], " ", 
    RowBox[{
     RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
    RowBox[{
     RowBox[{"Mp", "[", "\[Delta]", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Beta]00", "=", 
  RowBox[{
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"zm", "+", "ss"}], ")"}], "2"], "\[Beta]s"], "+", 
   "\[Beta]s"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Alpha]00", "=", 
  FractionBox[
   RowBox[{"(", 
    RowBox[{"zm", "+", "ss"}], ")"}], "\[Beta]s"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]0", "[", "d_", "]"}], ":=", 
   RowBox[{"\[Beta]00", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"r", " ", "d"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]0", "[", "d_", "]"}], ":=", 
   RowBox[{"\[Alpha]00", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"p", " ", "d"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]0", "[", "d_", "]"}], ":=", 
   FractionBox[
    RowBox[{"1", "+", 
     SuperscriptBox[
      RowBox[{"\[Alpha]0", "[", "d", "]"}], "2"]}], 
    RowBox[{"\[Beta]0", "[", "d", "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]p", "[", 
    RowBox[{"\[Delta]_", ",", "r_", ",", "p_"}], "]"}], "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"\[Beta]", "[", "\[Delta]", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]p", "[", 
    RowBox[{"\[Delta]_", ",", "r_", ",", "p_"}], "]"}], "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"\[Alpha]", "[", "\[Delta]", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.746533493755747*^9, 3.7465336345088797`*^9}, {
   3.746533715225523*^9, 3.746533731280881*^9}, {3.746533777615713*^9, 
   3.746533823093302*^9}, {3.746533986646391*^9, 3.7465341240214643`*^9}, {
   3.7465341884849663`*^9, 3.7465343166315813`*^9}, {3.746534395921982*^9, 
   3.7465344819813137`*^9}, {3.746534836704255*^9, 3.746534877284917*^9}, {
   3.7465349902776833`*^9, 3.746534996194235*^9}, {3.746535530152224*^9, 
   3.74653553475101*^9}, {3.746535566390321*^9, 3.7465357778264837`*^9}, {
   3.7465382557030993`*^9, 3.746538270777113*^9}, {3.7465385361974707`*^9, 
   3.7465385803336067`*^9}, {3.7465401177210493`*^9, 3.7465401222582083`*^9}, 
   3.7465503459044228`*^9, {3.746550522617857*^9, 3.746550550711339*^9}, {
   3.7465522302898283`*^9, 3.746552293983466*^9}, {3.74715908015869*^9, 
   3.747159215443902*^9}, {3.747159376069399*^9, 3.7471593774681683`*^9}, {
   3.747159427511725*^9, 3.747159428156355*^9}}],

Cell[BoxData["279.96983111805145`"], "Output",
 CellChangeTimes->{
  3.746534878308929*^9, 3.746535733864811*^9, 3.746535780543792*^9, {
   3.746538273137947*^9, 3.7465383195170803`*^9}, {3.746538537603009*^9, 
   3.746538585698739*^9}, 3.7465386941189823`*^9, 3.746540118568392*^9, {
   3.746540183986844*^9, 3.746540202428976*^9}, 3.7465402442085543`*^9, 
   3.746540319173827*^9, {3.746540398279805*^9, 3.746540474566762*^9}, 
   3.7465430340297003`*^9, 3.746543927352293*^9, 3.746544266538196*^9, 
   3.746544313569582*^9, {3.746545639368434*^9, 3.746545653812516*^9}, 
   3.746546396372473*^9, {3.7465469488108797`*^9, 3.7465469647602863`*^9}, 
   3.746547448613175*^9, 3.746547490338028*^9, {3.746547528386568*^9, 
   3.7465475677529984`*^9}, 3.746547626660783*^9, 3.746547688653944*^9, {
   3.746547750935707*^9, 3.746547774066126*^9}, {3.74654870711178*^9, 
   3.746548756463983*^9}, 3.746548792201911*^9, 3.746548859158032*^9, {
   3.746548963112125*^9, 3.746548988794793*^9}, 3.746549039510272*^9, 
   3.7465492469370203`*^9, 3.746549405723302*^9, 3.746549731665873*^9, 
   3.74654979731688*^9, 3.746550347098961*^9, 3.746550529872773*^9, 
   3.746550753984042*^9, 3.7465509667945843`*^9, 3.74655218882066*^9, 
   3.7465522360699253`*^9, {3.746552267524641*^9, 3.746552300663753*^9}, 
   3.746555551912443*^9, 3.7465562888075733`*^9, 3.746556497136984*^9, 
   3.746556600960421*^9, 3.746556801970079*^9, 3.7465573834852953`*^9, 
   3.746557673670301*^9, 3.746563097022246*^9, 3.747145004569109*^9, {
   3.747147050219056*^9, 3.747147068886774*^9}, 3.7471479002758627`*^9, 
   3.747148616830729*^9, 3.747148771630562*^9, 3.7471593454609337`*^9, 
   3.7471593781959352`*^9, 3.7471594301278973`*^9, {3.747159654445969*^9, 
   3.747159673997694*^9}, 3.747160146356514*^9}],

Cell[BoxData["5.195862114394988`"], "Output",
 CellChangeTimes->{
  3.746534878308929*^9, 3.746535733864811*^9, 3.746535780543792*^9, {
   3.746538273137947*^9, 3.7465383195170803`*^9}, {3.746538537603009*^9, 
   3.746538585698739*^9}, 3.7465386941189823`*^9, 3.746540118568392*^9, {
   3.746540183986844*^9, 3.746540202428976*^9}, 3.7465402442085543`*^9, 
   3.746540319173827*^9, {3.746540398279805*^9, 3.746540474566762*^9}, 
   3.7465430340297003`*^9, 3.746543927352293*^9, 3.746544266538196*^9, 
   3.746544313569582*^9, {3.746545639368434*^9, 3.746545653812516*^9}, 
   3.746546396372473*^9, {3.7465469488108797`*^9, 3.7465469647602863`*^9}, 
   3.746547448613175*^9, 3.746547490338028*^9, {3.746547528386568*^9, 
   3.7465475677529984`*^9}, 3.746547626660783*^9, 3.746547688653944*^9, {
   3.746547750935707*^9, 3.746547774066126*^9}, {3.74654870711178*^9, 
   3.746548756463983*^9}, 3.746548792201911*^9, 3.746548859158032*^9, {
   3.746548963112125*^9, 3.746548988794793*^9}, 3.746549039510272*^9, 
   3.7465492469370203`*^9, 3.746549405723302*^9, 3.746549731665873*^9, 
   3.74654979731688*^9, 3.746550347098961*^9, 3.746550529872773*^9, 
   3.746550753984042*^9, 3.7465509667945843`*^9, 3.74655218882066*^9, 
   3.7465522360699253`*^9, {3.746552267524641*^9, 3.746552300663753*^9}, 
   3.746555551912443*^9, 3.7465562888075733`*^9, 3.746556497136984*^9, 
   3.746556600960421*^9, 3.746556801970079*^9, 3.7465573834852953`*^9, 
   3.746557673670301*^9, 3.746563097022246*^9, 3.747145004569109*^9, {
   3.747147050219056*^9, 3.747147068886774*^9}, 3.7471479002758627`*^9, 
   3.747148616830729*^9, 3.747148771630562*^9, 3.7471593454609337`*^9, 
   3.7471593781959352`*^9, 3.7471594301278973`*^9, {3.747159654445969*^9, 
   3.747159673997694*^9}, 3.747160146357566*^9}]
}, Open  ]],

Cell["\<\
Plot the beta function for the beam as a function of the chromatic parameter.\
\
\>", "Text",
 CellChangeTimes->{{3.746534885245552*^9, 3.746534915696459*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"\[Beta]p", "[", 
      RowBox[{"\[Delta]", ",", " ", "r", ",", "p"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Delta]", ",", 
       RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "2"}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "1"}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"\[Alpha]p", "[", 
      RowBox[{"\[Delta]", ",", " ", "r", ",", "p"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Delta]", ",", 
       RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "2"}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "1"}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7465346956959963`*^9, 3.7465347233917217`*^9}, {
   3.746534759949666*^9, 3.746534824530526*^9}, {3.746534858511386*^9, 
   3.746534865344886*^9}, {3.7465357890649433`*^9, 3.746535855808653*^9}, {
   3.746549390560931*^9, 3.746549401373974*^9}, {3.7471469516877403`*^9, 
   3.747146960038076*^9}, {3.747147060128212*^9, 3.747147063753364*^9}, {
   3.747148577240385*^9, 3.747148580255229*^9}, 3.74714861332848*^9, {
   3.747159231860444*^9, 3.747159340620109*^9}, {3.747159421389443*^9, 
   3.747159422607522*^9}},
 NumberMarks->False],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`p$$ = 1, $CellContext`r$$ = 2, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`r$$], 2}, -5, 5}, {{
       Hold[$CellContext`p$$], 1}, -5, 5}}, Typeset`size$$ = {
    360., {106., 112.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`r$155919$$ = 
    0, $CellContext`p$155920$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`p$$ = 1, $CellContext`r$$ = 2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`r$$, $CellContext`r$155919$$, 0], 
        Hold[$CellContext`p$$, $CellContext`p$155920$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        $CellContext`\[Beta]p[$CellContext`\[Delta], $CellContext`r$$, \
$CellContext`p$$], {$CellContext`\[Delta], -0.01, 0.01}], 
      "Specifications" :> {{{$CellContext`r$$, 2}, -5, 
         5}, {{$CellContext`p$$, 1}, -5, 5}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{407., {162., 169.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.746534534235487*^9, 3.7465347243322897`*^9, {3.7465347667197113`*^9, 
   3.7465347792207127`*^9}, {3.746534811395673*^9, 3.7465348254146767`*^9}, {
   3.746534866228222*^9, 3.74653488128832*^9}, 3.7465358095990133`*^9, 
   3.746535857702264*^9, {3.746538280460977*^9, 3.746538320157476*^9}, 
   3.746538585914826*^9, 3.746538694384267*^9, {3.746540184527216*^9, 
   3.746540202658216*^9}, 3.746540244740488*^9, 3.746540319735313*^9, {
   3.7465403987492113`*^9, 3.746540474838689*^9}, 3.746543034584867*^9, 
   3.746543928037609*^9, 3.746544267270726*^9, 3.7465443142297907`*^9, 
   3.746545654250448*^9, 3.746546396666616*^9, {3.74654694934149*^9, 
   3.746546965500338*^9}, 3.7465474489870977`*^9, 3.74654749067057*^9, {
   3.746547528659809*^9, 3.74654756800016*^9}, 3.746547626884116*^9, 
   3.746547688871297*^9, {3.746547751155795*^9, 3.7465477743161507`*^9}, {
   3.746548707323648*^9, 3.746548756774274*^9}, 3.7465487926053753`*^9, 
   3.746548859573925*^9, {3.746548963364867*^9, 3.746548989094379*^9}, 
   3.746549039806446*^9, 3.7465492472314453`*^9, 3.7465494061987*^9, 
   3.74654973207978*^9, 3.746549801234354*^9, 3.746550755021891*^9, 
   3.746552189420952*^9, {3.746552285954997*^9, 3.746552301406393*^9}, 
   3.7465555522939997`*^9, 3.746556289191*^9, 3.746556497547553*^9, 
   3.7465566014683657`*^9, 3.746556802301612*^9, 3.7465573842810507`*^9, 
   3.7465576740743237`*^9, 3.746563098256851*^9, 3.747145004986733*^9, 
   3.747146963513835*^9, {3.7471470505994587`*^9, 3.747147069271282*^9}, 
   3.747147900726961*^9, 3.7471485823365717`*^9, 3.747148617154338*^9, 
   3.747148772167687*^9, 3.747159346648459*^9, 3.747159431599698*^9, {
   3.7471596559957247`*^9, 3.7471596753738956`*^9}, 3.7471601478417883`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`p$$ = 1, $CellContext`r$$ = 2, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`r$$], 2}, -5, 5}, {{
       Hold[$CellContext`p$$], 1}, -5, 5}}, Typeset`size$$ = {
    360., {106., 112.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`r$155948$$ = 
    0, $CellContext`p$155949$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`p$$ = 1, $CellContext`r$$ = 2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`r$$, $CellContext`r$155948$$, 0], 
        Hold[$CellContext`p$$, $CellContext`p$155949$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        $CellContext`\[Alpha]p[$CellContext`\[Delta], $CellContext`r$$, \
$CellContext`p$$], {$CellContext`\[Delta], -0.01, 0.01}], 
      "Specifications" :> {{{$CellContext`r$$, 2}, -5, 
         5}, {{$CellContext`p$$, 1}, -5, 5}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{407., {162., 169.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.746534534235487*^9, 3.7465347243322897`*^9, {3.7465347667197113`*^9, 
   3.7465347792207127`*^9}, {3.746534811395673*^9, 3.7465348254146767`*^9}, {
   3.746534866228222*^9, 3.74653488128832*^9}, 3.7465358095990133`*^9, 
   3.746535857702264*^9, {3.746538280460977*^9, 3.746538320157476*^9}, 
   3.746538585914826*^9, 3.746538694384267*^9, {3.746540184527216*^9, 
   3.746540202658216*^9}, 3.746540244740488*^9, 3.746540319735313*^9, {
   3.7465403987492113`*^9, 3.746540474838689*^9}, 3.746543034584867*^9, 
   3.746543928037609*^9, 3.746544267270726*^9, 3.7465443142297907`*^9, 
   3.746545654250448*^9, 3.746546396666616*^9, {3.74654694934149*^9, 
   3.746546965500338*^9}, 3.7465474489870977`*^9, 3.74654749067057*^9, {
   3.746547528659809*^9, 3.74654756800016*^9}, 3.746547626884116*^9, 
   3.746547688871297*^9, {3.746547751155795*^9, 3.7465477743161507`*^9}, {
   3.746548707323648*^9, 3.746548756774274*^9}, 3.7465487926053753`*^9, 
   3.746548859573925*^9, {3.746548963364867*^9, 3.746548989094379*^9}, 
   3.746549039806446*^9, 3.7465492472314453`*^9, 3.7465494061987*^9, 
   3.74654973207978*^9, 3.746549801234354*^9, 3.746550755021891*^9, 
   3.746552189420952*^9, {3.746552285954997*^9, 3.746552301406393*^9}, 
   3.7465555522939997`*^9, 3.746556289191*^9, 3.746556497547553*^9, 
   3.7465566014683657`*^9, 3.746556802301612*^9, 3.7465573842810507`*^9, 
   3.7465576740743237`*^9, 3.746563098256851*^9, 3.747145004986733*^9, 
   3.747146963513835*^9, {3.7471470505994587`*^9, 3.747147069271282*^9}, 
   3.747147900726961*^9, 3.7471485823365717`*^9, 3.747148617154338*^9, 
   3.747148772167687*^9, 3.747159346648459*^9, 3.747159431599698*^9, {
   3.7471596559957247`*^9, 3.7471596753738956`*^9}, 3.747160147875886*^9}]
}, Open  ]],

Cell["\<\
For the range of r we are considering, the beta and alpha functions are still \
linear function of the incoming beam, which is good, we can handle that. \
\>", "Text",
 CellChangeTimes->{{3.7465349604553432`*^9, 3.746534987000399*^9}, {
  3.746536265084859*^9, 3.7465363202465477`*^9}, {3.7465363632513847`*^9, 
  3.746536364883304*^9}, {3.7465369296972027`*^9, 3.746536935841004*^9}, {
  3.746538380069799*^9, 3.746538388982977*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"\[Beta]p", "[", 
    RowBox[{"\[Delta]", ",", "r", ",", "p"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", ",", "0", ",", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"\[Alpha]p", "[", 
    RowBox[{"\[Delta]", ",", "r", ",", "p"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.746538421421987*^9, 3.746538466370266*^9}, {
  3.7465385052435827`*^9, 3.746538506738576*^9}, {3.7465399940558023`*^9, 
  3.74653999517912*^9}, {3.747159645437498*^9, 3.747159669267988*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"9.061586118010412`", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.6419883684486825`", "\[VeryThinSpace]", "+", 
      RowBox[{"9.275622178713133`", " ", "p"}], "-", 
      RowBox[{"18.159620442183183`", " ", "r"}]}], ")"}], " ", "\[Delta]"}], 
   "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1.6186610610849905`"}], "-", 
      RowBox[{"1.1323204661760837`", " ", "p"}], "+", 
      RowBox[{"242.23831923915162`", " ", 
       SuperscriptBox["p", "2"]}], "-", 
      RowBox[{"0.5862820329238385`", " ", "r"}], "-", 
      RowBox[{"484.4766384783032`", " ", "p", " ", "r"}], "+", 
      RowBox[{"251.21111142989184`", " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[Delta]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Delta]", "]"}], "3"],
    SeriesData[$CellContext`\[Delta], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Delta], 0, {
   9.061586118010412, 1.6419883684486825` + 9.275622178713133 $CellContext`p - 
    18.159620442183183` $CellContext`r, -1.6186610610849905` - 
    1.1323204661760837` $CellContext`p + 242.23831923915162` $CellContext`p^2 - 
    0.5862820329238385 $CellContext`r - 
    484.4766384783032 $CellContext`p $CellContext`r + 
    251.21111142989184` $CellContext`r^2}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.746538450334383*^9, 3.7465384672991858`*^9}, 
   3.746538586022705*^9, 3.7465386944681683`*^9, 3.746539996659412*^9, 
   3.7465401846145067`*^9, 3.7465402448623238`*^9, 3.746540319824773*^9, {
   3.7465403988393717`*^9, 3.7465404749250526`*^9}, 3.746543034687687*^9, 
   3.746543928234847*^9, 3.746544267805303*^9, 3.746544314636045*^9, 
   3.746545654426879*^9, 3.746546396809252*^9, {3.746546949600381*^9, 
   3.746546965628351*^9}, 3.746547449136847*^9, 3.7465474908058853`*^9, {
   3.746547528819868*^9, 3.746547568085123*^9}, 3.746547627000319*^9, 
   3.746547688985705*^9, {3.746547751266179*^9, 3.7465477744044228`*^9}, {
   3.74654870743653*^9, 3.746548756880609*^9}, 3.746548792726528*^9, 
   3.746548859724978*^9, {3.74654896347913*^9, 3.746548989178146*^9}, 
   3.746549039891518*^9, 3.746549247315864*^9, 3.7465494063378353`*^9, 
   3.7465497322352867`*^9, 3.746550755254301*^9, 3.7465521900190277`*^9, {
   3.746552286526278*^9, 3.7465523257907467`*^9}, 3.746555552465838*^9, 
   3.746556289367362*^9, 3.746556497644794*^9, 3.7465566016674623`*^9, 
   3.7465568023917923`*^9, 3.746557384949925*^9, 3.74655767420891*^9, 
   3.746563098457925*^9, 3.747145005167037*^9, {3.747147050825416*^9, 
   3.747147069593375*^9}, 3.747147901067655*^9, 3.747148617285338*^9, 
   3.747148772364691*^9, 3.747159346733203*^9, 3.7471594316832867`*^9, {
   3.7471596560831337`*^9, 3.7471596754625273`*^9}, 3.747160147929059*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"0.09708495212495444`", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "0.32762857762636993`"}], "-", 
      RowBox[{"4.974241250518733`", " ", "p"}], "+", 
      RowBox[{"4.682841685717765`", " ", "r"}]}], ")"}], " ", "\[Delta]"}], 
   "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"0.28857786427061166`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.46830419341623397`", " ", "p"}], "+", 
      RowBox[{"5.243954971323527`", " ", 
       SuperscriptBox["p", "2"]}], "+", 
      RowBox[{"0.8462820158744897`", " ", "r"}], "-", 
      RowBox[{"10.487909942647057`", " ", "p", " ", "r"}], "+", 
      RowBox[{"5.438197229786489`", " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[Delta]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Delta]", "]"}], "3"],
    SeriesData[$CellContext`\[Delta], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Delta], 0, {
   0.09708495212495444, -0.32762857762636993` - 
    4.974241250518733 $CellContext`p + 4.682841685717765 $CellContext`r, 
    0.28857786427061166` - 0.46830419341623397` $CellContext`p + 
    5.243954971323527 $CellContext`p^2 + 0.8462820158744897 $CellContext`r - 
    10.487909942647057` $CellContext`p $CellContext`r + 
    5.438197229786489 $CellContext`r^2}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.746538450334383*^9, 3.7465384672991858`*^9}, 
   3.746538586022705*^9, 3.7465386944681683`*^9, 3.746539996659412*^9, 
   3.7465401846145067`*^9, 3.7465402448623238`*^9, 3.746540319824773*^9, {
   3.7465403988393717`*^9, 3.7465404749250526`*^9}, 3.746543034687687*^9, 
   3.746543928234847*^9, 3.746544267805303*^9, 3.746544314636045*^9, 
   3.746545654426879*^9, 3.746546396809252*^9, {3.746546949600381*^9, 
   3.746546965628351*^9}, 3.746547449136847*^9, 3.7465474908058853`*^9, {
   3.746547528819868*^9, 3.746547568085123*^9}, 3.746547627000319*^9, 
   3.746547688985705*^9, {3.746547751266179*^9, 3.7465477744044228`*^9}, {
   3.74654870743653*^9, 3.746548756880609*^9}, 3.746548792726528*^9, 
   3.746548859724978*^9, {3.74654896347913*^9, 3.746548989178146*^9}, 
   3.746549039891518*^9, 3.746549247315864*^9, 3.7465494063378353`*^9, 
   3.7465497322352867`*^9, 3.746550755254301*^9, 3.7465521900190277`*^9, {
   3.746552286526278*^9, 3.7465523257907467`*^9}, 3.746555552465838*^9, 
   3.746556289367362*^9, 3.746556497644794*^9, 3.7465566016674623`*^9, 
   3.7465568023917923`*^9, 3.746557384949925*^9, 3.74655767420891*^9, 
   3.746563098457925*^9, 3.747145005167037*^9, {3.747147050825416*^9, 
   3.747147069593375*^9}, 3.747147901067655*^9, 3.747148617285338*^9, 
   3.747148772364691*^9, 3.747159346733203*^9, 3.7471594316832867`*^9, {
   3.7471596560831337`*^9, 3.7471596754625273`*^9}, 3.74716014793046*^9}]
}, Open  ]],

Cell["\<\
The chromatic emittance growth is a little messy to calculate.\
\>", "Text",
 CellChangeTimes->{{3.746554751979097*^9, 3.746554772189163*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Alpha]0", ",", " ", "\[Beta]0", ",", " ", "\[Gamma]0"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox["\[Delta]", "2"]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", "s", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.746556283603951*^9, 3.746556319667738*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]a", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"c3", "[", "\[Delta]", "]"}], " ", 
       FractionBox["\[Delta]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", 
           RowBox[{"\[Psi]", "[", 
            RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"c2", "[", "\[Delta]", "]"}], " ", 
       SqrtBox[
        RowBox[{"1", "+", "\[Delta]"}]], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{"c0", "[", "\[Delta]", "]"}], "+", 
      RowBox[{
       RowBox[{"c1", "[", "\[Delta]", "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]a", "[", 
    RowBox[{"s_", ",", "d_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Beta]a", "[", 
        RowBox[{"s", ",", "d"}], "]"}], ",", "s"}], "]"}]}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c0", "[", "\[Delta]_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Beta]0", "[", "\[Delta]", "]"}], "\[Beta]m0"], "+", 
      RowBox[{"\[Beta]m0", " ", 
       RowBox[{"\[Gamma]0", "[", "\[Delta]", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"\[Alpha]0", "[", "\[Delta]", "]"}], " ", "\[Alpha]m"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c1", "[", "\[Delta]_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Beta]0", "[", "\[Delta]", "]"}], "\[Beta]m0"], "-", 
      RowBox[{"\[Beta]m0", " ", 
       RowBox[{"\[Gamma]0", "[", "\[Delta]", "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"\[Alpha]0", "[", "\[Delta]", "]"}], " ", "\[Alpha]m"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c2", "[", "\[Delta]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"\[Alpha]0", "[", "\[Delta]", "]"}]}], "+", 
    FractionBox[
     RowBox[{"\[Alpha]m", " ", 
      RowBox[{"\[Beta]0", "[", "\[Delta]", "]"}]}], "\[Beta]m0"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"c3", "[", "\[Delta]_", "]"}], ":=", 
    RowBox[{
     RowBox[{"\[Beta]m0", " ", 
      RowBox[{"\[Gamma]0", "[", "\[Delta]", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"\[Alpha]0", "[", "\[Delta]", "]"}], " ", "\[Alpha]m"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]m", "[", "s_", "]"}], ":=", 
     FractionBox["1", 
      SqrtBox[
       RowBox[{"\[Eta]", "[", 
        RowBox[{"s", "+", "st"}], "]"}]]]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]m0", "=", 
   FractionBox["1", 
    SqrtBox[
     RowBox[{"\[Eta]", "[", "st", "]"}]]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.746552466664133*^9, 3.746552475284215*^9}, {
  3.7465546103728237`*^9, 3.746554689605748*^9}, {3.746554779093782*^9, 
  3.74655486110183*^9}, {3.746555081391512*^9, 3.746555222837187*^9}, {
  3.746555259765583*^9, 3.746555358677194*^9}, {3.746555406661243*^9, 
  3.7465554767410793`*^9}, {3.7465555257806587`*^9, 3.746555533277111*^9}, {
  3.746556654414034*^9, 3.746556729342531*^9}, {3.74655677562151*^9, 
  3.7465567971233788`*^9}}],

Cell["\<\
Start adding in the initial conditions from the perturbative section.\
\>", "Text",
 CellChangeTimes->{{3.746555579188231*^9, 3.746555594460544*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]0", "[", "\[Delta]_", "]"}], ":=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"\[Beta]p", "[", 
       RowBox[{"\[Delta]", ",", "r"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Delta]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]0", "[", "\[Delta]_", "]"}], ":=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"\[Alpha]p", "[", 
       RowBox[{"\[Delta]", ",", "r"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Delta]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]0", "[", "\[Delta]_", "]"}], ":=", 
   FractionBox[
    RowBox[{"1", "+", 
     SuperscriptBox[
      RowBox[{"\[Alpha]0", "[", "\[Delta]", "]"}], "2"]}], 
    RowBox[{"\[Beta]0", "[", "\[Delta]", "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Beta]", "[", "s_", "]"}], "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Beta]a", "[", 
       RowBox[{"s", ",", "\[Delta]"}], "]"}], ",", "\[Delta]"}], "]"}], "]"}],
    "/.", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", "\[Rule]", "0"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Alpha]", "[", "s_", "]"}], "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Alpha]a", "[", 
       RowBox[{"s", ",", "\[Delta]"}], "]"}], ",", "\[Delta]"}], "]"}], "]"}],
    "/.", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", "\[Rule]", "0"}], 
    "}"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.74655560444757*^9, 3.746555746177953*^9}, {
  3.746556250699924*^9, 3.7465562581795683`*^9}, {3.7465563549569817`*^9, 
  3.746556375123371*^9}, {3.7465564935644283`*^9, 3.746556494244609*^9}, {
  3.746556532979192*^9, 3.746556651411459*^9}, {3.746556849958763*^9, 
  3.746556862282785*^9}, {3.7465569405257063`*^9, 3.7465569407304907`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.2`"}], " ", 
        RowBox[{"\[Alpha]p", "[", 
         RowBox[{"0", ",", "r"}], "]"}]}], "+", 
       FractionBox[
        RowBox[{"9.128709291752768`", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"\[Alpha]p", "[", 
             RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}]}], 
        RowBox[{"\[Beta]p", "[", 
         RowBox[{"0", ",", "r"}], "]"}]]}], ")"}]}], "-", 
    RowBox[{"1.`", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]p", "[", 
        RowBox[{"0", ",", "r"}], "]"}], "-", 
       RowBox[{"0.010954451150103323`", " ", 
        RowBox[{"\[Beta]p", "[", 
         RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"2.`", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]p", "[", 
        RowBox[{"0", ",", "r"}], "]"}], "-", 
       RowBox[{"0.010954451150103323`", " ", 
        RowBox[{"\[Beta]p", "[", 
         RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.2`", " ", 
        RowBox[{"\[Alpha]p", "[", 
         RowBox[{"0", ",", "r"}], "]"}]}], "-", 
       FractionBox[
        RowBox[{"9.128709291752768`", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"\[Alpha]p", "[", 
             RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}]}], 
        RowBox[{"\[Beta]p", "[", 
         RowBox[{"0", ",", "r"}], "]"}]], "+", 
       RowBox[{"0.10954451150103323`", " ", 
        RowBox[{"\[Beta]p", "[", 
         RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "-", 
    RowBox[{"0.2`", " ", 
     RowBox[{
      SuperscriptBox["\[Alpha]p", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"0", ",", "r"}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"18.257418583505537`", " ", 
      RowBox[{"\[Alpha]p", "[", 
       RowBox[{"0", ",", "r"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Alpha]p", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"0", ",", "r"}], "]"}]}], 
     RowBox[{"\[Beta]p", "[", 
      RowBox[{"0", ",", "r"}], "]"}]], "-", 
    RowBox[{"2.`", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Alpha]p", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"0", ",", "r"}], "]"}], "-", 
       RowBox[{"0.010954451150103323`", " ", 
        RowBox[{
         SuperscriptBox["\[Beta]p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"0.10954451150103323`", " ", 
     RowBox[{
      SuperscriptBox["\[Beta]p", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"0", ",", "r"}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"9.128709291752768`", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"\[Alpha]p", "[", 
          RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\[Beta]p", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"0", ",", "r"}], "]"}]}], 
     SuperscriptBox[
      RowBox[{"\[Beta]p", "[", 
       RowBox[{"0", ",", "r"}], "]"}], "2"]], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.2`", " ", 
        RowBox[{
         SuperscriptBox["\[Alpha]p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"0", ",", "r"}], "]"}]}], "-", 
       FractionBox[
        RowBox[{"18.257418583505537`", " ", 
         RowBox[{"\[Alpha]p", "[", 
          RowBox[{"0", ",", "r"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Alpha]p", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"0", ",", "r"}], "]"}]}], 
        RowBox[{"\[Beta]p", "[", 
         RowBox[{"0", ",", "r"}], "]"}]], "+", 
       RowBox[{"0.10954451150103323`", " ", 
        RowBox[{
         SuperscriptBox["\[Beta]p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"0", ",", "r"}], "]"}]}], "+", 
       FractionBox[
        RowBox[{"9.128709291752768`", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"\[Alpha]p", "[", 
             RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]p", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"0", ",", "r"}], "]"}]}], 
        SuperscriptBox[
         RowBox[{"\[Beta]p", "[", 
          RowBox[{"0", ",", "r"}], "]"}], "2"]]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.746556593032217*^9, 3.746556602224701*^9}, 
   3.7465566390836782`*^9, 3.7465567382066603`*^9, 3.746556802855908*^9, 
   3.7465568672632093`*^9, 3.746556943328529*^9, 3.7465573854552794`*^9, 
   3.7465576746486683`*^9, 3.746563099571439*^9, 3.747145005812542*^9, {
   3.747147051615285*^9, 3.74714707027046*^9}, 3.7471479017769527`*^9, 
   3.747148617966104*^9, 3.7471487731405067`*^9, 3.747159348428729*^9, 
   3.7471594332481337`*^9, {3.747159657661035*^9, 3.747159677163065*^9}, 
   3.747160149524763*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{
      SuperscriptBox["\[Beta]m", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.2`"}], " ", 
           RowBox[{"\[Alpha]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}], "+", 
          FractionBox[
           RowBox[{"9.128709291752768`", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"\[Alpha]p", "[", 
                RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}]}], 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]]}], ")"}]}], "-", 
       RowBox[{"1.`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Alpha]p", "[", 
           RowBox[{"0", ",", "r"}], "]"}], "-", 
          RowBox[{"0.010954451150103323`", " ", 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"2.`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Alpha]p", "[", 
           RowBox[{"0", ",", "r"}], "]"}], "-", 
          RowBox[{"0.010954451150103323`", " ", 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.2`", " ", 
           RowBox[{"\[Alpha]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}], "-", 
          FractionBox[
           RowBox[{"9.128709291752768`", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"\[Alpha]p", "[", 
                RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}]}], 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]], "+", 
          RowBox[{"0.10954451150103323`", " ", 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "-", 
       RowBox[{"0.2`", " ", 
        RowBox[{
         SuperscriptBox["\[Alpha]p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"0", ",", "r"}], "]"}]}], "+", 
       FractionBox[
        RowBox[{"18.257418583505537`", " ", 
         RowBox[{"\[Alpha]p", "[", 
          RowBox[{"0", ",", "r"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Alpha]p", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"0", ",", "r"}], "]"}]}], 
        RowBox[{"\[Beta]p", "[", 
         RowBox[{"0", ",", "r"}], "]"}]], "-", 
       RowBox[{"2.`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Alpha]p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"0", ",", "r"}], "]"}], "-", 
          RowBox[{"0.010954451150103323`", " ", 
           RowBox[{
            SuperscriptBox["\[Beta]p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"0.10954451150103323`", " ", 
        RowBox[{
         SuperscriptBox["\[Beta]p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"0", ",", "r"}], "]"}]}], "-", 
       FractionBox[
        RowBox[{"9.128709291752768`", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"\[Alpha]p", "[", 
             RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]p", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"0", ",", "r"}], "]"}]}], 
        SuperscriptBox[
         RowBox[{"\[Beta]p", "[", 
          RowBox[{"0", ",", "r"}], "]"}], "2"]], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.2`", " ", 
           RowBox[{
            SuperscriptBox["\[Alpha]p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"0", ",", "r"}], "]"}]}], "-", 
          FractionBox[
           RowBox[{"18.257418583505537`", " ", 
            RowBox[{"\[Alpha]p", "[", 
             RowBox[{"0", ",", "r"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Alpha]p", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"0", ",", "r"}], "]"}]}], 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]], "+", 
          RowBox[{"0.10954451150103323`", " ", 
           RowBox[{
            SuperscriptBox["\[Beta]p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"0", ",", "r"}], "]"}]}], "+", 
          FractionBox[
           RowBox[{"9.128709291752768`", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"\[Alpha]p", "[", 
                RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}], " ", 
            RowBox[{
             SuperscriptBox["\[Beta]p", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"0", ",", "r"}], "]"}]}], 
           SuperscriptBox[
            RowBox[{"\[Beta]p", "[", 
             RowBox[{"0", ",", "r"}], "]"}], "2"]]}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"\[Beta]m", "[", "s", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.2`"}], " ", 
           RowBox[{"\[Alpha]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}], "+", 
          FractionBox[
           RowBox[{"9.128709291752768`", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"\[Alpha]p", "[", 
                RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}]}], 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.2`", " ", 
           RowBox[{"\[Alpha]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}], "-", 
          FractionBox[
           RowBox[{"9.128709291752768`", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"\[Alpha]p", "[", 
                RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}]}], 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]], "+", 
          RowBox[{"0.10954451150103323`", " ", 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"4.`", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Alpha]p", "[", 
           RowBox[{"0", ",", "r"}], "]"}], "-", 
          RowBox[{"0.010954451150103323`", " ", 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.2`", " ", 
           RowBox[{"\[Alpha]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}], "-", 
          FractionBox[
           RowBox[{"9.128709291752768`", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"\[Alpha]p", "[", 
                RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}]}], 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]], "+", 
          RowBox[{"0.10954451150103323`", " ", 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "-", 
       RowBox[{"4.`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Alpha]p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"0", ",", "r"}], "]"}], "-", 
          RowBox[{"0.010954451150103323`", " ", 
           RowBox[{
            SuperscriptBox["\[Beta]p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"0", ",", "r"}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.2`", " ", 
           RowBox[{
            SuperscriptBox["\[Alpha]p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"0", ",", "r"}], "]"}]}], "-", 
          FractionBox[
           RowBox[{"18.257418583505537`", " ", 
            RowBox[{"\[Alpha]p", "[", 
             RowBox[{"0", ",", "r"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["\[Alpha]p", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"0", ",", "r"}], "]"}]}], 
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "r"}], "]"}]], "+", 
          RowBox[{"0.10954451150103323`", " ", 
           RowBox[{
            SuperscriptBox["\[Beta]p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"0", ",", "r"}], "]"}]}], "+", 
          FractionBox[
           RowBox[{"9.128709291752768`", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"\[Alpha]p", "[", 
                RowBox[{"0", ",", "r"}], "]"}], "2"]}], ")"}], " ", 
            RowBox[{
             SuperscriptBox["\[Beta]p", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"0", ",", "r"}], "]"}]}], 
           SuperscriptBox[
            RowBox[{"\[Beta]p", "[", 
             RowBox[{"0", ",", "r"}], "]"}], "2"]]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.746556593032217*^9, 3.746556602224701*^9}, 
   3.7465566390836782`*^9, 3.7465567382066603`*^9, 3.746556802855908*^9, 
   3.7465568672632093`*^9, 3.746556943328529*^9, 3.7465573854552794`*^9, 
   3.7465576746486683`*^9, 3.746563099571439*^9, 3.747145005812542*^9, {
   3.747147051615285*^9, 3.74714707027046*^9}, 3.7471479017769527`*^9, 
   3.747148617966104*^9, 3.7471487731405067`*^9, 3.747159348428729*^9, 
   3.7471594332481337`*^9, {3.747159657661035*^9, 3.747159677163065*^9}, 
   3.74716015483144*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W2", "[", "s_", "]"}], "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d\[Alpha]", "[", "s", "]"}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"\[Beta]m", "'"}], "[", "s", "]"}], 
         RowBox[{"2", " ", 
          RowBox[{"\[Beta]m", "[", "s", "]"}]}]], " ", 
        RowBox[{"d\[Beta]", "[", "s", "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"\[Beta]m", "[", "s", "]"}]], " ", 
       RowBox[{"d\[Beta]", "[", "s", "]"}]}], ")"}], "2"]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7465568746082497`*^9, 3.746556952546378*^9}, {
   3.746556992788014*^9, 3.746557028772429*^9}, {3.7465571692342176`*^9, 
   3.746557172726213*^9}, 3.7465572316060743`*^9, 3.7465573072338743`*^9, {
   3.746557345386215*^9, 3.7465573473531523`*^9}, {3.746557665845709*^9, 
   3.7465576691084023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"\[Beta]p", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "4"]], "0.00012`", " ", 
   SuperscriptBox[
    RowBox[{"\[Beta]m", "[", "s", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", "s", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]p", "[", 
        RowBox[{"0", ",", "2"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
          RowBox[{"\[Beta]p", "[", 
           RowBox[{"0", ",", "2"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "91.28709291752767`"}], " ", 
             RowBox[{"\[Alpha]p", "[", 
              RowBox[{"0", ",", "2"}], "]"}]}], "+", 
            RowBox[{"1.`", " ", 
             RowBox[{"\[Beta]p", "[", 
              RowBox[{"0", ",", "2"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "416.66666666666663`"}], "-", 
            RowBox[{"416.66666666666663`", " ", 
             SuperscriptBox[
              RowBox[{"\[Alpha]p", "[", 
               RowBox[{"0", ",", "2"}], "]"}], "2"]}], "+", 
            RowBox[{"9.128709291752768`", " ", 
             RowBox[{"\[Alpha]p", "[", 
              RowBox[{"0", ",", "2"}], "]"}], " ", 
             RowBox[{"\[Beta]p", "[", 
              RowBox[{"0", ",", "2"}], "]"}]}], "+", 
            RowBox[{"5.`", " ", 
             SuperscriptBox[
              RowBox[{"\[Beta]p", "[", 
               RowBox[{"0", ",", "2"}], "]"}], "2"]}]}], ")"}]}]}], ")"}], 
       " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"\[Beta]p", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "91.28709291752767`"}], " ", 
          RowBox[{
           SuperscriptBox["\[Alpha]p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"0", ",", "2"}], "]"}]}], "+", 
         RowBox[{"1.`", " ", 
          RowBox[{
           SuperscriptBox["\[Beta]p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"0", ",", "2"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2.5`", " ", 
          SuperscriptBox[
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "2"}], "]"}], "3"]}], "+", 
         RowBox[{
          RowBox[{"\[Beta]p", "[", 
           RowBox[{"0", ",", "2"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"208.33333333333331`", "\[VeryThinSpace]", "+", 
            RowBox[{"208.33333333333331`", " ", 
             SuperscriptBox[
              RowBox[{"\[Alpha]p", "[", 
               RowBox[{"0", ",", "2"}], "]"}], "2"]}], "+", 
            RowBox[{"833.3333333333333`", " ", 
             RowBox[{"\[Alpha]p", "[", 
              RowBox[{"0", ",", "2"}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["\[Alpha]p", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"0", ",", "2"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "2"}], "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4.564354645876384`"}], " ", 
             RowBox[{"\[Alpha]p", "[", 
              RowBox[{"0", ",", "2"}], "]"}]}], "-", 
            RowBox[{"9.128709291752768`", " ", 
             RowBox[{
              SuperscriptBox["\[Alpha]p", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"0", ",", "2"}], "]"}]}], "-", 
            RowBox[{"5.`", " ", 
             RowBox[{
              SuperscriptBox["\[Beta]p", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"0", ",", "2"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "416.66666666666663`"}], "-", 
            RowBox[{"416.66666666666663`", " ", 
             SuperscriptBox[
              RowBox[{"\[Alpha]p", "[", 
               RowBox[{"0", ",", "2"}], "]"}], "2"]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["\[Beta]p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"0", ",", "2"}], "]"}]}]}], ")"}]}]}], ")"}], "2"]}], "+", 
  
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "s", "]"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.2`"}], " ", 
          RowBox[{"\[Alpha]p", "[", 
           RowBox[{"0", ",", "2"}], "]"}]}], "+", 
         FractionBox[
          RowBox[{"9.128709291752768`", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"\[Alpha]p", "[", 
               RowBox[{"0", ",", "2"}], "]"}], "2"]}], ")"}]}], 
          RowBox[{"\[Beta]p", "[", 
           RowBox[{"0", ",", "2"}], "]"}]]}], ")"}]}], "-", 
      RowBox[{"1.`", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Alpha]p", "[", 
          RowBox[{"0", ",", "2"}], "]"}], "-", 
         RowBox[{"0.010954451150103323`", " ", 
          RowBox[{"\[Beta]p", "[", 
           RowBox[{"0", ",", "2"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2.`", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Alpha]p", "[", 
          RowBox[{"0", ",", "2"}], "]"}], "-", 
         RowBox[{"0.010954451150103323`", " ", 
          RowBox[{"\[Beta]p", "[", 
           RowBox[{"0", ",", "2"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"0.2`", " ", 
          RowBox[{"\[Alpha]p", "[", 
           RowBox[{"0", ",", "2"}], "]"}]}], "-", 
         FractionBox[
          RowBox[{"9.128709291752768`", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"\[Alpha]p", "[", 
               RowBox[{"0", ",", "2"}], "]"}], "2"]}], ")"}]}], 
          RowBox[{"\[Beta]p", "[", 
           RowBox[{"0", ",", "2"}], "]"}]], "+", 
         RowBox[{"0.10954451150103323`", " ", 
          RowBox[{"\[Beta]p", "[", 
           RowBox[{"0", ",", "2"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "-", 
      RowBox[{"0.2`", " ", 
       RowBox[{
        SuperscriptBox["\[Alpha]p", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"0", ",", "2"}], "]"}]}], "+", 
      FractionBox[
       RowBox[{"18.257418583505537`", " ", 
        RowBox[{"\[Alpha]p", "[", 
         RowBox[{"0", ",", "2"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Alpha]p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"0", ",", "2"}], "]"}]}], 
       RowBox[{"\[Beta]p", "[", 
        RowBox[{"0", ",", "2"}], "]"}]], "-", 
      RowBox[{"2.`", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Alpha]p", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"0", ",", "2"}], "]"}], "-", 
         RowBox[{"0.010954451150103323`", " ", 
          RowBox[{
           SuperscriptBox["\[Beta]p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"0", ",", "2"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"0.10954451150103323`", " ", 
       RowBox[{
        SuperscriptBox["\[Beta]p", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"0", ",", "2"}], "]"}]}], "-", 
      FractionBox[
       RowBox[{"9.128709291752768`", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"\[Alpha]p", "[", 
            RowBox[{"0", ",", "2"}], "]"}], "2"]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Beta]p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"0", ",", "2"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"\[Beta]p", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "2"]], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.2`", "\[VeryThinSpace]", "-", 
            FractionBox[
             RowBox[{"18.257418583505537`", " ", 
              RowBox[{"\[Alpha]p", "[", 
               RowBox[{"0", ",", "2"}], "]"}]}], 
             RowBox[{"\[Beta]p", "[", 
              RowBox[{"0", ",", "2"}], "]"}]]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["\[Alpha]p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"0", ",", "2"}], "]"}]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"9.128709291752768`", "\[VeryThinSpace]", "+", 
             RowBox[{"9.128709291752768`", " ", 
              SuperscriptBox[
               RowBox[{"\[Alpha]p", "[", 
                RowBox[{"0", ",", "2"}], "]"}], "2"]}], "+", 
             RowBox[{"0.10954451150103323`", " ", 
              SuperscriptBox[
               RowBox[{"\[Beta]p", "[", 
                RowBox[{"0", ",", "2"}], "]"}], "2"]}]}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["\[Beta]p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"0", ",", "2"}], "]"}]}], 
          SuperscriptBox[
           RowBox[{"\[Beta]p", "[", 
            RowBox[{"0", ",", "2"}], "]"}], "2"]]}], ")"}]}]}], ")"}], 
    "2"]}]}]], "Output",
 CellChangeTimes->{{3.746556927100135*^9, 3.7465569534139013`*^9}, 
   3.7465569975950613`*^9, 3.7465570295179977`*^9, 3.746557173412113*^9, 
   3.7465572340433817`*^9, 3.7465573091529093`*^9, 3.746557349862257*^9, 
   3.746557387311873*^9, {3.7465576705048532`*^9, 3.7465576762082*^9}, 
   3.746563101236065*^9, 3.74714500741083*^9, {3.7471470531792316`*^9, 
   3.74714707175764*^9}, 3.747147903414473*^9, 3.747148619586526*^9, 
   3.747148774836817*^9, 3.747159355167367*^9, 3.74715944003442*^9, {
   3.747159664472577*^9, 3.7471596840646687`*^9}, 3.7471601563715267`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", "s_", "]"}], ":=", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "0", "s"], 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Beta]m", "[", "x", "]"}]], " ", 
     RowBox[{"\[DifferentialD]", "x"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]m", "[", "s_", "]"}], ":=", 
   FractionBox["1", 
    SqrtBox[
     RowBox[{"\[Eta]", "[", 
      RowBox[{"s", "+", "st"}], "]"}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"W2", "[", "s", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "50"}], "}"}]}], "]"}], "*)"}]}]}], "Input",\

 CellChangeTimes->{{3.746557334895966*^9, 3.7465573574808693`*^9}, {
   3.746557409900609*^9, 3.746557420691701*^9}, 3.746557659141469*^9, 
   3.746558228367326*^9, {3.746563087754228*^9, 3.746563090184596*^9}}],

Cell["\<\
It seems like it will be easier to calculate the emittance growth \
analytically first and then plug in numbers. I did this by hand and got a \
much nicer solution, must have made a mistake here.\
\>", "Text",
 CellChangeTimes->{{3.746562857086285*^9, 3.746562886950131*^9}, {
  3.7471601670368567`*^9, 3.747160185836547*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"r", ",", "\[Beta]m", ",", "\[Alpha]m", ",", "\[Theta]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox["\[Delta]", "2"]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", "s", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Beta]m", " ", "[", "s", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "+", 
         RowBox[{"r", " ", "\[Delta]"}]}]], " ", 
       FractionBox["\[Delta]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", 
           RowBox[{"\[Psi]", "[", 
            RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"r", " ", "\[Delta]"}], "+", 
         FractionBox["1", 
          RowBox[{"1", "+", 
           RowBox[{"r", " ", "\[Delta]"}]}]]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"r", " ", "\[Delta]"}], "-", 
         FractionBox["1", 
          RowBox[{"1", "+", 
           RowBox[{"r", " ", "\[Delta]"}]}]]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], ",", "\[Delta]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Delta]", "\[Rule]", "0"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.746562893721665*^9, 3.7465630785548487`*^9}, 
   3.746563125235489*^9, {3.746563609561908*^9, 3.746563611023328*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
  RowBox[{"\[Beta]m", "[", "s", "]"}]}]], "Output",
 CellChangeTimes->{{3.746563101392927*^9, 3.746563126226387*^9}, 
   3.746563794304051*^9, 3.7471450076546*^9, {3.7471470532494173`*^9, 
   3.747147071875736*^9}, 3.747147903603907*^9, 3.747148619778068*^9, 
   3.747148774979471*^9, 3.747159355209118*^9, 3.747159440072062*^9, {
   3.747159664521431*^9, 3.7471596841147623`*^9}, 3.747160156430455*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", "[", 
    RowBox[{"s_", ",", "\[Delta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[Alpha]m", "[", "s", "]"}], 
      RowBox[{"\[Beta]m", "[", "s", "]"}]], " ", 
     RowBox[{"\[Beta]", "[", 
      RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "+", 
         RowBox[{"r", " ", "\[Delta]"}]}]], " ", 
       FractionBox["\[Delta]", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"r", " ", "\[Delta]"}], "-", 
         FractionBox["1", 
          RowBox[{"1", "+", 
           RowBox[{"r", " ", "\[Delta]"}]}]]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"s", ",", "\[Delta]"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"\[Alpha]", "[", 
     RowBox[{"s", ",", "\[Delta]"}], "]"}], ",", "\[Delta]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Delta]", "\[Rule]", "0"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.746563586009987*^9, 3.746563606894773*^9}, {
  3.746563637175791*^9, 3.746563747612914*^9}, {3.746563780183777*^9, 
  3.7465638002217493`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
  RowBox[{"r", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"\[Alpha]m", "[", "s", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.746563738193221*^9, 3.746563748515175*^9}, 
   3.746563801787624*^9, 3.747145007813818*^9, {3.747147053324836*^9, 
   3.7471470718888483`*^9}, 3.747147903822732*^9, 3.7471486199024887`*^9, 
   3.7471487751220427`*^9, 3.7471593552225103`*^9, 3.747159440084148*^9, {
   3.747159664538505*^9, 3.747159684133328*^9}, 3.7471601564503117`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"W2", "[", "s_", "]"}], "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r", "-", 
         FractionBox["1", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], 
    "2"]}]}]], "Input",
 CellChangeTimes->{{3.74656399784489*^9, 3.746564063677403*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], "+", "r"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], 
   "2"]}]], "Output",
 CellChangeTimes->{
  3.746564064331253*^9, 3.747145007960149*^9, {3.747147053434492*^9, 
   3.7471470719963617`*^9}, 3.7471479039764433`*^9, 3.747148620028202*^9, 
   3.747148775302381*^9, 3.747159355226365*^9, 3.74715944009678*^9, 
   3.747159684137355*^9, 3.747160156454167*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], "+", "r"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}], ")"}], "2"]}], 
  "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "+", 
  SuperscriptBox["r", "2"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "+", "r"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}], "-", 
  RowBox[{"r", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"4", " ", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.7465640663368883`*^9, 3.7471450080714903`*^9, {3.747147053584777*^9, 
   3.7471470721526213`*^9}, 3.747147904161933*^9, 3.747148620191595*^9, 
   3.747148775403655*^9, 3.7471593552528563`*^9, 3.7471594401220407`*^9, 
   3.747159684168817*^9, 3.74716015648623*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 1028},
WindowMargins->{{Automatic, 960}, {0, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 558, 12, 56, "Input"],
Cell[CellGroupData[{
Cell[1141, 36, 117, 1, 35, "Subsubsection"],
Cell[1261, 39, 212, 4, 33, "Text"],
Cell[1476, 45, 1518, 52, 209, "Input"],
Cell[2997, 99, 370, 6, 77, "Text"],
Cell[CellGroupData[{
Cell[3392, 109, 1225, 33, 137, "Input"],
Cell[4620, 144, 2195, 34, 60, "Output"],
Cell[6818, 180, 2151, 31, 34, "Output"],
Cell[8972, 213, 2217, 34, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11226, 252, 2562, 67, 205, "Input"],
Cell[13791, 321, 2919, 51, 49, "Output"]
}, Open  ]],
Cell[16725, 375, 308, 6, 33, "Text"],
Cell[CellGroupData[{
Cell[17058, 385, 1085, 20, 124, "Input"],
Cell[18146, 407, 2842, 49, 34, "Output"]
}, Open  ]],
Cell[21003, 459, 120, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[21148, 464, 777, 17, 56, "Input"],
Cell[21928, 483, 2156, 35, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24121, 523, 695, 15, 55, "Input"],
Cell[24819, 540, 858, 12, 32, "Output"]
}, Open  ]],
Cell[25692, 555, 142, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[25859, 560, 3240, 71, 127, "Input"],
Cell[29102, 633, 3109, 46, 34, "Output"],
Cell[32214, 681, 3029, 43, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35280, 729, 414, 10, 56, "Input"],
Cell[35697, 741, 1883, 26, 32, "Output"]
}, Open  ]],
Cell[37595, 770, 213, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[37833, 778, 952, 25, 185, "Input"],
Cell[38788, 805, 1887, 27, 32, "Output"],
Cell[40678, 834, 3409, 72, 76, "Output"]
}, Open  ]],
Cell[44102, 909, 165, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[44292, 916, 4960, 135, 368, "Input"],
Cell[49255, 1053, 1778, 25, 32, "Output"],
Cell[51036, 1080, 1777, 25, 32, "Output"]
}, Open  ]],
Cell[52828, 1108, 169, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[53022, 1116, 1772, 47, 57, "Input"],
Cell[54797, 1165, 3626, 63, 348, "Output"],
Cell[58426, 1230, 3625, 63, 348, "Output"]
}, Open  ]],
Cell[62066, 1296, 444, 7, 55, "Text"],
Cell[CellGroupData[{
Cell[62535, 1307, 672, 16, 57, "Input"],
Cell[63210, 1325, 2854, 53, 59, "Output"],
Cell[66067, 1380, 2857, 53, 59, "Output"]
}, Open  ]],
Cell[68939, 1436, 152, 3, 33, "Text"],
Cell[69094, 1441, 476, 13, 75, "Input"],
Cell[69573, 1456, 3862, 113, 348, "Input"],
Cell[73438, 1571, 159, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[73622, 1578, 2090, 59, 178, "Input"],
Cell[75715, 1639, 7076, 207, 298, "Output"],
Cell[82794, 1848, 13799, 375, 641, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96630, 2228, 1077, 29, 83, "Input"],
Cell[97710, 2259, 12990, 357, 535, "Output"]
}, Open  ]],
Cell[110715, 2619, 932, 27, 132, "Input"],
Cell[111650, 2648, 336, 6, 55, "Text"],
Cell[CellGroupData[{
Cell[112011, 2658, 2077, 61, 165, "Input"],
Cell[114091, 2721, 817, 20, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114945, 2746, 1529, 45, 80, "Input"],
Cell[116477, 2793, 1129, 30, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117643, 2828, 859, 28, 53, "Input"],
Cell[118505, 2858, 1025, 31, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119567, 2894, 821, 28, 53, "Input"],
Cell[120391, 2924, 732, 20, 49, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

